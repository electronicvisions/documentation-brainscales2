<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>calix.common.cadc.ChannelOffsetCalib &mdash; BrainScaleS-2 Documentation 0.0.1 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/visions.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="calix.common.cadc.RampOffsetCalib" href="calix.common.cadc.RampOffsetCalib.html" />
    <link rel="prev" title="calix.common.cadc.CADCCalibTarget" href="calix.common.cadc.CADCCalibTarget.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> BrainScaleS-2 Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../brainscales2-demos/index.html">Demos &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software_components.html">Software Components</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../apis.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../apis_python.html">Python API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pynn_brainscales.brainscales2.html">pynn_brainscales.brainscales2</a></li>
<li class="toctree-l3"><a class="reference internal" href="hxtorch.html">hxtorch</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygrenade_vx.html">pygrenade_vx</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="calix.html">calix</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="calix.calib_cache.html">calix.calib_cache</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="calix.common.html">calix.common</a></li>
<li class="toctree-l4"><a class="reference internal" href="calix.constants.html">calix.constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="calix.hagen.html">calix.hagen</a></li>
<li class="toctree-l4"><a class="reference internal" href="calix.spiking.html">calix.spiking</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../apis_cpp.html">C++ API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BrainScaleS-2 Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../apis.html">BrainScaleS-2 API Documentation</a> &raquo;</li>
          <li><a href="../apis_python.html">BrainScaleS-2 API Documentation</a> &raquo;</li>
          <li><a href="calix.html">calix</a> &raquo;</li>
          <li><a href="calix.common.html">calix.common</a> &raquo;</li>
          <li><a href="calix.common.cadc.html">calix.common.cadc</a> &raquo;</li>
      <li>calix.common.cadc.ChannelOffsetCalib</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/calix.common.cadc.ChannelOffsetCalib.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="calix-common-cadc-channeloffsetcalib">
<h1>calix.common.cadc.ChannelOffsetCalib<a class="headerlink" href="#calix-common-cadc-channeloffsetcalib" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt id="calix.common.cadc.ChannelOffsetCalib">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">calix.common.cadc.</span></code><code class="sig-name descname"><span class="pre">ChannelOffsetCalib</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamic_range_mid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pyhaldls_vx_v3.CapMemCell.Value</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">Value(310)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#calix.common.cadc.ChannelOffsetCalib" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="calix.common.base.Calib.html#calix.common.base.Calib" title="calix.common.base.Calib"><code class="xref py py-class docutils literal notranslate"><span class="pre">calix.common.base.Calib</span></code></a></p>
<p>CADC Calibration part 3: Calibrating digital offsets of individual
channels. This is done by setting an intermediate voltage at the
CADC debug line and setting the offsets such that all channels
read the same result.</p>
<p>As one measurement at constant voltage for all channels suffices, the
LinearPrediction algorithm can be used for calibration.</p>
<p>Requirements:
* All CADC channels are connected to the CADC debug line (can be</p>
<blockquote>
<div><p>achieved with <cite>cadc_helpers.configure_chip()</cite>).</p>
</div></blockquote>
<ul class="simple">
<li><p>CADC debug line connected to CapMem cell <cite>stp_v_charge_0</cite>
(can be archived with <cite>cadc_helpers.configure_readout_cadc_debug()</cite>)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamic_range_mid</strong> – Mean of dynamic range min and max. The CADC
channels should read medium results (around 120-128) there, if the
range and read targets in the previous parts are set up sensible.
The voltage is configured as <cite>stp_v_charge_0</cite>, which has to be
connected to the CADCs via the CapMem debug readout.</p></li>
<li><p><strong>initial_results</strong> – CADC reads before calibrating the offsets.
Stored to print statistics after calibration.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="calix.common.cadc.ChannelOffsetCalib.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamic_range_mid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pyhaldls_vx_v3.CapMemCell.Value</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">Value(310)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#calix.common.cadc.ChannelOffsetCalib.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#calix.common.cadc.ChannelOffsetCalib.__init__" title="calix.common.cadc.ChannelOffsetCalib.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>([dynamic_range_mid])</p></td>
<td><p>Initialize self.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#calix.common.cadc.ChannelOffsetCalib.configure_parameters" title="calix.common.cadc.ChannelOffsetCalib.configure_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">configure_parameters</span></code></a>(builder, parameters)</p></td>
<td><p>Set up the given CADC channel offsets.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#calix.common.cadc.ChannelOffsetCalib.find_target_read" title="calix.common.cadc.ChannelOffsetCalib.find_target_read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_target_read</span></code></a>(reads)</p></td>
<td><p>Inspect a given array of CADC Samples and return the median read of all CADC channels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#calix.common.cadc.ChannelOffsetCalib.measure_results" title="calix.common.cadc.ChannelOffsetCalib.measure_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">measure_results</span></code></a>(connection, builder)</p></td>
<td><p>Read all CADC channels on chip.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#calix.common.cadc.ChannelOffsetCalib.postlude" title="calix.common.cadc.ChannelOffsetCalib.postlude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postlude</span></code></a>(connection)</p></td>
<td><p>Print statistics about the CADC reads before and after calibration.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#calix.common.cadc.ChannelOffsetCalib.prelude" title="calix.common.cadc.ChannelOffsetCalib.prelude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prelude</span></code></a>(connection)</p></td>
<td><p>Configure debug readout cell to roughly the middle of the desired dynamic CADC range.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="calix.common.cadc.ChannelOffsetCalib.configure_parameters">
<code class="sig-name descname"><span class="pre">configure_parameters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">builder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="calix.common.base.WriteRecordingPlaybackProgramBuilder.html#calix.common.base.WriteRecordingPlaybackProgramBuilder" title="calix.common.base.WriteRecordingPlaybackProgramBuilder"><span class="pre">calix.common.base.WriteRecordingPlaybackProgramBuilder</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="calix.common.base.WriteRecordingPlaybackProgramBuilder.html#calix.common.base.WriteRecordingPlaybackProgramBuilder" title="calix.common.base.WriteRecordingPlaybackProgramBuilder"><span class="pre">calix.common.base.WriteRecordingPlaybackProgramBuilder</span></a><a class="headerlink" href="#calix.common.cadc.ChannelOffsetCalib.configure_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Set up the given CADC channel offsets.
Expects the given parameter array to be ordered like the iter_all
of CADCChannelConfigOnDLS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>builder</strong> – Builder to append configuration instructions to.</p></li>
<li><p><strong>parameters</strong> – CADC channel offsets to set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Builder with configuration instructions appended.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calix.common.cadc.ChannelOffsetCalib.find_target_read">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">find_target_read</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reads</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">int</span><a class="headerlink" href="#calix.common.cadc.ChannelOffsetCalib.find_target_read" title="Permalink to this definition"></a></dt>
<dd><p>Inspect a given array of CADC Samples and return the median
read of all CADC channels. This will be used as target read
when calculating the individual channel offsets.</p>
<p>If the median of all CADC channels is far off the expected value,
a warning is logged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reads</strong> – Array of CADC Samples for both synrams obtained at
a constant common voltage.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Calib target for individual CADC channel offsets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calix.common.cadc.ChannelOffsetCalib.measure_results">
<code class="sig-name descname"><span class="pre">measure_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pyhxcomm_vx.ConnectionHandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">builder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="calix.common.base.WriteRecordingPlaybackProgramBuilder.html#calix.common.base.WriteRecordingPlaybackProgramBuilder" title="calix.common.base.WriteRecordingPlaybackProgramBuilder"><span class="pre">calix.common.base.WriteRecordingPlaybackProgramBuilder</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="headerlink" href="#calix.common.cadc.ChannelOffsetCalib.measure_results" title="Permalink to this definition"></a></dt>
<dd><p>Read all CADC channels on chip.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection</strong> – Connection to the chip to calibrate.</p></li>
<li><p><strong>builder</strong> – Builder to append read instructions to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array containing integer results for each channel.
The order is top causal, top acausal,
bottom causal, bottom acausal;
within these blocks the channels are ordered from left to right.
The order of returned results corresponds to the enums of
halco.CADCChannelConfigOnDLS.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calix.common.cadc.ChannelOffsetCalib.postlude">
<code class="sig-name descname"><span class="pre">postlude</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pyhxcomm_vx.ConnectionHandle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#calix.common.cadc.ChannelOffsetCalib.postlude" title="Permalink to this definition"></a></dt>
<dd><p>Print statistics about the CADC reads before and after calibration.
Data after calibration is measured using the connection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>connection</strong> – Connection to the chip to run on.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calix.common.cadc.ChannelOffsetCalib.prelude">
<code class="sig-name descname"><span class="pre">prelude</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pyhxcomm_vx.ConnectionHandle</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="headerlink" href="#calix.common.cadc.ChannelOffsetCalib.prelude" title="Permalink to this definition"></a></dt>
<dd><p>Configure debug readout cell to roughly the middle of the
desired dynamic CADC range.
Measure the target read to aim for when calculating the offsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>connection</strong> – Connection to the chip to calibrate.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="calix.common.cadc.CADCCalibTarget.html" class="btn btn-neutral float-left" title="calix.common.cadc.CADCCalibTarget" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="calix.common.cadc.RampOffsetCalib.html" class="btn btn-neutral float-right" title="calix.common.cadc.RampOffsetCalib" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Electronic Vision(s).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>