<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>calix.hagen.neuron_leak_bias &mdash; BrainScaleS-2 Documentation 0.0.1 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/visions.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="calix.hagen.neuron_leak_bias.LeakBiasCalib" href="calix.hagen.neuron_leak_bias.LeakBiasCalib.html" />
    <link rel="prev" title="calix.hagen.neuron_helpers.CADCReadNeurons" href="calix.hagen.neuron_helpers.CADCReadNeurons.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> BrainScaleS-2 Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../brainscales2-demos/index.html">Demos &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software_components.html">Software Components</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../apis.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api_pynn-brainscales2.html">PyNN API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_hxtorch.html">hxtorch API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_grenade.html">grenade API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_haldls.html">haldls API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_lola.html">lola API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_stadls.html">stadls API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_fisch.html">fisch API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_hxcomm.html">hxcomm API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api_calix.html">calix API</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="calix.html">calix</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="calix.calib_cache.html">calix.calib_cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="calix.common.html">calix.common</a></li>
<li class="toctree-l4"><a class="reference internal" href="calix.constants.html">calix.constants</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="calix.hagen.html">calix.hagen</a></li>
<li class="toctree-l4"><a class="reference internal" href="calix.spiking.html">calix.spiking</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_hate.html">hate API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BrainScaleS-2 Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../apis.html">BrainScaleS-2 API Documentation</a> &raquo;</li>
          <li><a href="../api_calix.html">API Reference: calix</a> &raquo;</li>
          <li><a href="calix.html">calix</a> &raquo;</li>
          <li><a href="calix.hagen.html">calix.hagen</a> &raquo;</li>
      <li>calix.hagen.neuron_leak_bias</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/calix.hagen.neuron_leak_bias.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-calix.hagen.neuron_leak_bias">
<span id="calix-hagen-neuron-leak-bias"></span><h1>calix.hagen.neuron_leak_bias<a class="headerlink" href="#module-calix.hagen.neuron_leak_bias" title="Permalink to this headline"></a></h1>
<p>Provides functions to set the neurons’ leak OTA bias currents
for different purposes.</p>
<p>The class MembraneTimeConstCalibCADC measures the membrane
time constant and calibrates to set these equal.
This is done before the calibration of synaptic input amplitudes.</p>
<p>The class LeakBiasCalib is targeted at setting the leak OTA bias
current as low as possible while keeping the noise under control.
This is called after the synaptic inputs are calibrated.</p>
<p class="rubric">Classes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="calix.hagen.neuron_leak_bias.LeakBiasCalib.html#calix.hagen.neuron_leak_bias.LeakBiasCalib" title="calix.hagen.neuron_leak_bias.LeakBiasCalib"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LeakBiasCalib</span></code></a>(target, numpy.ndarray] = 1.2, …)</p></td>
<td><p>Set leak bias currents as low as possible while preventing the membrane voltage from floating and preventing too high membrane noise.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="calix.hagen.neuron_leak_bias.MembraneTimeConstCalibCADC.html#calix.hagen.neuron_leak_bias.MembraneTimeConstCalibCADC" title="calix.hagen.neuron_leak_bias.MembraneTimeConstCalibCADC"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MembraneTimeConstCalibCADC</span></code></a>(…)</p></td>
<td><p>Find the leak conductivity by resetting the neuron’s membrane to a potential significantly below the leak potential.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="calix.hagen.neuron_leak_bias.MembraneTimeConstCalibOffset.html#calix.hagen.neuron_leak_bias.MembraneTimeConstCalibOffset" title="calix.hagen.neuron_leak_bias.MembraneTimeConstCalibOffset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MembraneTimeConstCalibOffset</span></code></a>(target, …)</p></td>
<td><p>Measure response to step current with MADC to calibrate the membrane time constant.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="calix.hagen.neuron_leak_bias.MembraneTimeConstCalibReset.html#calix.hagen.neuron_leak_bias.MembraneTimeConstCalibReset" title="calix.hagen.neuron_leak_bias.MembraneTimeConstCalibReset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MembraneTimeConstCalibReset</span></code></a>(target, …)</p></td>
<td><p>Measure neuron reset with the MADC to calibrate the membrane time constant.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Functions</p>
<dl class="py function">
<dt id="calix.hagen.neuron_leak_bias.curve_fit">
<code class="sig-prename descclassname"><span class="pre">calix.hagen.neuron_leak_bias.</span></code><code class="sig-name descname"><span class="pre">curve_fit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_finite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-</span> <span class="pre">inf,</span> <span class="pre">inf)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#calix.hagen.neuron_leak_bias.curve_fit" title="Permalink to this definition"></a></dt>
<dd><p>Use non-linear least squares to fit a function, f, to data.</p>
<p>Assumes <code class="docutils literal notranslate"><span class="pre">ydata</span> <span class="pre">=</span> <span class="pre">f(xdata,</span> <span class="pre">*params)</span> <span class="pre">+</span> <span class="pre">eps</span></code>.</p>
<dl>
<dt>f<span class="classifier">callable</span></dt><dd><p>The model function, f(x, …). It must take the independent
variable as the first argument and the parameters to fit as
separate remaining arguments.</p>
</dd>
<dt>xdata<span class="classifier">array_like</span></dt><dd><p>The independent variable where the data is measured.
Should usually be an M-length sequence or an (k,M)-shaped array for
functions with k predictors, and each element should be float
convertible if it is an array like object.</p>
</dd>
<dt>ydata<span class="classifier">array_like</span></dt><dd><p>The dependent data, a length M array - nominally <code class="docutils literal notranslate"><span class="pre">f(xdata,</span> <span class="pre">...)</span></code>.</p>
</dd>
<dt>p0<span class="classifier">array_like, optional</span></dt><dd><p>Initial guess for the parameters (length N). If None, then the
initial values will all be 1 (if the number of parameters for the
function can be determined using introspection, otherwise a
ValueError is raised).</p>
</dd>
<dt>sigma<span class="classifier">None or M-length sequence or MxM array, optional</span></dt><dd><p>Determines the uncertainty in <cite>ydata</cite>. If we define residuals as
<code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">ydata</span> <span class="pre">-</span> <span class="pre">f(xdata,</span> <span class="pre">*popt)</span></code>, then the interpretation of <cite>sigma</cite>
depends on its number of dimensions:</p>
<blockquote>
<div><ul>
<li><p>A 1-D <cite>sigma</cite> should contain values of standard deviations of
errors in <cite>ydata</cite>. In this case, the optimized function is
<code class="docutils literal notranslate"><span class="pre">chisq</span> <span class="pre">=</span> <span class="pre">sum((r</span> <span class="pre">/</span> <span class="pre">sigma)</span> <span class="pre">**</span> <span class="pre">2)</span></code>.</p></li>
<li><p>A 2-D <cite>sigma</cite> should contain the covariance matrix of
errors in <cite>ydata</cite>. In this case, the optimized function is
<code class="docutils literal notranslate"><span class="pre">chisq</span> <span class="pre">=</span> <span class="pre">r.T</span> <span class="pre">&#64;</span> <span class="pre">inv(sigma)</span> <span class="pre">&#64;</span> <span class="pre">r</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.</span></p>
</div>
</li>
</ul>
</div></blockquote>
<p>None (default) is equivalent of 1-D <cite>sigma</cite> filled with ones.</p>
</dd>
<dt>absolute_sigma<span class="classifier">bool, optional</span></dt><dd><p>If True, <cite>sigma</cite> is used in an absolute sense and the estimated parameter
covariance <cite>pcov</cite> reflects these absolute values.</p>
<p>If False (default), only the relative magnitudes of the <cite>sigma</cite> values matter.
The returned parameter covariance matrix <cite>pcov</cite> is based on scaling
<cite>sigma</cite> by a constant factor. This constant is set by demanding that the
reduced <cite>chisq</cite> for the optimal parameters <cite>popt</cite> when using the
<em>scaled</em> <cite>sigma</cite> equals unity. In other words, <cite>sigma</cite> is scaled to
match the sample variance of the residuals after the fit. Default is False.
Mathematically,
<code class="docutils literal notranslate"><span class="pre">pcov(absolute_sigma=False)</span> <span class="pre">=</span> <span class="pre">pcov(absolute_sigma=True)</span> <span class="pre">*</span> <span class="pre">chisq(popt)/(M-N)</span></code></p>
</dd>
<dt>check_finite<span class="classifier">bool, optional</span></dt><dd><p>If True, check that the input arrays do not contain nans of infs,
and raise a ValueError if they do. Setting this parameter to
False may silently produce nonsensical results if the input arrays
do contain nans. Default is True.</p>
</dd>
<dt>bounds<span class="classifier">2-tuple of array_like or <cite>Bounds</cite>, optional</span></dt><dd><p>Lower and upper bounds on parameters. Defaults to no bounds.
There are two ways to specify the bounds:</p>
<blockquote>
<div><ul class="simple">
<li><p>Instance of <cite>Bounds</cite> class.</p></li>
<li><p>2-tuple of array_like: Each element of the tuple must be either
an array with the length equal to the number of parameters, or a
scalar (in which case the bound is taken to be the same for all
parameters). Use <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> with an appropriate sign to disable
bounds on all or some parameters.</p></li>
</ul>
</div></blockquote>
</dd>
<dt>method<span class="classifier">{‘lm’, ‘trf’, ‘dogbox’}, optional</span></dt><dd><p>Method to use for optimization. See <cite>least_squares</cite> for more details.
Default is ‘lm’ for unconstrained problems and ‘trf’ if <cite>bounds</cite> are
provided. The method ‘lm’ won’t work when the number of observations
is less than the number of variables, use ‘trf’ or ‘dogbox’ in this
case.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.</span></p>
</div>
</dd>
<dt>jac<span class="classifier">callable, string or None, optional</span></dt><dd><p>Function with signature <code class="docutils literal notranslate"><span class="pre">jac(x,</span> <span class="pre">...)</span></code> which computes the Jacobian
matrix of the model function with respect to parameters as a dense
array_like structure. It will be scaled according to provided <cite>sigma</cite>.
If None (default), the Jacobian will be estimated numerically.
String keywords for ‘trf’ and ‘dogbox’ methods can be used to select
a finite difference scheme, see <cite>least_squares</cite>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.18.</span></p>
</div>
</dd>
<dt>full_output<span class="classifier">boolean, optional</span></dt><dd><p>If True, this function returns additioal information: <cite>infodict</cite>,
<cite>mesg</cite>, and <cite>ier</cite>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.9.</span></p>
</div>
</dd>
<dt><a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs</dt><dd><p>Keyword arguments passed to <cite>leastsq</cite> for <code class="docutils literal notranslate"><span class="pre">method='lm'</span></code> or
<cite>least_squares</cite> otherwise.</p>
</dd>
</dl>
<dl>
<dt>popt<span class="classifier">array</span></dt><dd><p>Optimal values for the parameters so that the sum of the squared
residuals of <code class="docutils literal notranslate"><span class="pre">f(xdata,</span> <span class="pre">*popt)</span> <span class="pre">-</span> <span class="pre">ydata</span></code> is minimized.</p>
</dd>
<dt>pcov<span class="classifier">2-D array</span></dt><dd><p>The estimated covariance of popt. The diagonals provide the variance
of the parameter estimate. To compute one standard deviation errors
on the parameters use <code class="docutils literal notranslate"><span class="pre">perr</span> <span class="pre">=</span> <span class="pre">np.sqrt(np.diag(pcov))</span></code>.</p>
<p>How the <cite>sigma</cite> parameter affects the estimated covariance
depends on <cite>absolute_sigma</cite> argument, as described above.</p>
<p>If the Jacobian matrix at the solution doesn’t have a full rank, then
‘lm’ method returns a matrix filled with <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>, on the other hand
‘trf’  and ‘dogbox’ methods use Moore-Penrose pseudoinverse to compute
the covariance matrix.</p>
</dd>
<dt>infodict<span class="classifier">dict (returned only if <cite>full_output</cite> is True)</span></dt><dd><p>a dictionary of optional outputs with the keys:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">nfev</span></code></dt><dd><p>The number of function calls. Methods ‘trf’ and ‘dogbox’ do not
count function calls for numerical Jacobian approximation,
as opposed to ‘lm’ method.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fvec</span></code></dt><dd><p>The function values evaluated at the solution.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fjac</span></code></dt><dd><p>A permutation of the R matrix of a QR
factorization of the final approximate
Jacobian matrix, stored column wise.
Together with ipvt, the covariance of the
estimate can be approximated.
Method ‘lm’ only provides this information.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ipvt</span></code></dt><dd><p>An integer array of length N which defines
a permutation matrix, p, such that
fjac*p = q*r, where r is upper triangular
with diagonal elements of nonincreasing
magnitude. Column j of p is column ipvt(j)
of the identity matrix.
Method ‘lm’ only provides this information.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">qtf</span></code></dt><dd><p>The vector (transpose(q) * fvec).
Method ‘lm’ only provides this information.</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.9.</span></p>
</div>
</dd>
<dt>mesg<span class="classifier">str (returned only if <cite>full_output</cite> is True)</span></dt><dd><p>A string message giving information about the solution.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.9.</span></p>
</div>
</dd>
<dt>ier<span class="classifier">int (returnned only if <cite>full_output</cite> is True)</span></dt><dd><p>An integer flag. If it is equal to 1, 2, 3 or 4, the solution was
found. Otherwise, the solution was not found. In either case, the
optional output variable <cite>mesg</cite> gives more information.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.9.</span></p>
</div>
</dd>
</dl>
<dl class="simple">
<dt>ValueError</dt><dd><p>if either <cite>ydata</cite> or <cite>xdata</cite> contain NaNs, or if incompatible options
are used.</p>
</dd>
<dt>RuntimeError</dt><dd><p>if the least-squares minimization fails.</p>
</dd>
<dt>OptimizeWarning</dt><dd><p>if covariance of the parameters can not be estimated.</p>
</dd>
</dl>
<p>least_squares : Minimize the sum of squares of nonlinear functions.
scipy.stats.linregress : Calculate a linear least squares regression for</p>
<blockquote>
<div><p>two sets of measurements.</p>
</div></blockquote>
<p>Users should ensure that inputs <cite>xdata</cite>, <cite>ydata</cite>, and the output of <cite>f</cite>
are <code class="docutils literal notranslate"><span class="pre">float64</span></code>, or else the optimization may return incorrect results.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">method='lm'</span></code>, the algorithm uses the Levenberg-Marquardt algorithm
through <cite>leastsq</cite>. Note that this algorithm can only deal with
unconstrained problems.</p>
<p>Box constraints can be handled by methods ‘trf’ and ‘dogbox’. Refer to
the docstring of <cite>least_squares</cite> for more information.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>
</div>
<p>Define the data to be fit with some noise:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_noise</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">xdata</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ydata</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y_noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Fit for the parameters a, b, c of the function <cite>func</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt</span>
<span class="go">array([2.56274217, 1.37268521, 0.47427475])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span>
<span class="gp">... </span>         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fit: a=</span><span class="si">%5.3f</span><span class="s1">, b=</span><span class="si">%5.3f</span><span class="s1">, c=</span><span class="si">%5.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">popt</span><span class="p">))</span>
</pre></div>
</div>
<p>Constrain the optimization to the region of <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">3</span></code>,
<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">b</span> <span class="pre">&lt;=</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">c</span> <span class="pre">&lt;=</span> <span class="pre">0.5</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt</span>
<span class="go">array([2.43736712, 1.        , 0.34463856])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span>
<span class="gp">... </span>         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fit: a=</span><span class="si">%5.3f</span><span class="s1">, b=</span><span class="si">%5.3f</span><span class="s1">, c=</span><span class="si">%5.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">popt</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="calix.hagen.neuron_helpers.CADCReadNeurons.html" class="btn btn-neutral float-left" title="calix.hagen.neuron_helpers.CADCReadNeurons" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="calix.hagen.neuron_leak_bias.LeakBiasCalib.html" class="btn btn-neutral float-right" title="calix.hagen.neuron_leak_bias.LeakBiasCalib" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Electronic Vision(s).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>