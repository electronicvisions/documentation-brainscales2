<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>calix.hagen.neuron_synin_coba.COBAReferenceCalib &mdash; BrainScaleS-2 Documentation 0.0.1 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/visions.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="calix.hagen.neuron_synin_coba.ExcCOBABiasCalib" href="calix.hagen.neuron_synin_coba.ExcCOBABiasCalib.html" />
    <link rel="prev" title="calix.hagen.neuron_synin_coba.COBABiasCalib" href="calix.hagen.neuron_synin_coba.COBABiasCalib.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            BrainScaleS-2 Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../brainscales2-demos/index.html">Demos &amp; Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software_components.html">Software Components</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../apis.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../apis_python.html">Python API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pynn_brainscales.brainscales2.html">pynn_brainscales.brainscales2</a></li>
<li class="toctree-l3"><a class="reference internal" href="jaxsnn.html">jaxsnn</a></li>
<li class="toctree-l3"><a class="reference internal" href="hxtorch.html">hxtorch</a></li>
<li class="toctree-l3"><a class="reference internal" href="pygrenade_vx.html">pygrenade_vx</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="calix.html">calix</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="calix.calib_cache.html">calix.calib_cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="calix.common.html">calix.common</a></li>
<li class="toctree-l4"><a class="reference internal" href="calix.constants.html">calix.constants</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="calix.hagen.html">calix.hagen</a></li>
<li class="toctree-l4"><a class="reference internal" href="calix.spiking.html">calix.spiking</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../apis_cpp.html">C++ API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BrainScaleS-2 Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../apis.html">BrainScaleS-2 API Documentation</a></li>
          <li class="breadcrumb-item"><a href="../apis_python.html">BrainScaleS-2 API Documentation</a></li>
          <li class="breadcrumb-item"><a href="calix.html">calix</a></li>
          <li class="breadcrumb-item"><a href="calix.hagen.html">calix.hagen</a></li>
          <li class="breadcrumb-item"><a href="calix.hagen.neuron_synin_coba.html">calix.hagen.neuron_synin_coba</a></li>
      <li class="breadcrumb-item active">calix.hagen.neuron_synin_coba.COBAReferenceCalib</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/calix.hagen.neuron_synin_coba.COBAReferenceCalib.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="calix-hagen-neuron-synin-coba-cobareferencecalib">
<h1>calix.hagen.neuron_synin_coba.COBAReferenceCalib<a class="headerlink" href="#calix-hagen-neuron-synin-coba-cobareferencecalib" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt id="calix.hagen.neuron_synin_coba.COBAReferenceCalib">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">calix.hagen.neuron_synin_coba.</span></code><code class="sig-name descname"><span class="pre">COBAReferenceCalib</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_events</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_potential</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_leak_parameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="calix.common.base.Calib.html#calix.common.base.Calib" title="calix.common.base.Calib"><code class="xref py py-class docutils literal notranslate"><span class="pre">calix.common.base.Calib</span></code></a></p>
<p>Calibrates the COBA reference potential.</p>
<p>The COBA OTA compares the membrane potential with its reference
potential and modulates the CUBA bias current accordingly. We
calibrate the reference potential such that the COBA OTA does not
generate an output current and therefore the original CUBA synaptic
amplitude is not modulated.</p>
<p>This calibration needs to be supplied with the original CUBA amplitude
as a target and the corresponding parameters how the amplitude
was measured. It then adjusts the COBA reference potential such that
the original CUBA amplitude is observed. Since the COBA OTA has this
reference potential and the membrane potential (here: leak potential)
as inputs, the reference potential equals the leak potential after
successful calibration.</p>
<p>Requirements:
* CADC is calibrated and neuron membrane potential is connected to</p>
<blockquote>
<div><p>the CADCs.</p>
</div></blockquote>
<ul class="simple">
<li><p>Leak potential is calibrated at the potential where the original
CUBA amplitudes should be unchanged. Note that if you use more
than one event (<cite>n_events</cite> &gt; 1) to measure amplitudes, consider
setting the leak potential slightly below/above the potential
where you want the same strength for a single synaptic event,
such that the potential is roughly at half the amplitude of
the synaptic events. This will counter the effect of the
amplitude modulation due to the COBA circuit.</p></li>
<li><p>The original CUBA amplitude is supplied as target.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cuba_bias_calib</strong> – Instance of the calibration for CUBA synaptic
input bias current. Used for measuring synaptic input amplitudes.</p></li>
<li><p><strong>target_potential</strong> – Target reference potential in CADC units.</p></li>
<li><p><strong>expected_leak_parameters</strong> – Leak parameters found at target
reference potential with COBA modulation disabled.</p></li>
<li><p><strong>allowed_deviation</strong> – Allowed deviation of resting potential from
given target_potential after COBA modulation is enabled. A high
deviation indicates a strong offset current generated from the
CUBA synaptic input OTA, which in turn means a strong change in
its bias current, i.e. a COBA modulation. Since the COBA modulation
should be zero at the reference potential, we counter this state
by adjusting the reference parameters. We try to measure the
correct direction of parameter update by testing higher and lower
parameters. In case the change in resting potential is not
significant, which can happen if the reference potential is far
off the target, we update the parameters in the direction of the
expected leak parameters - which match the expected reference
potentials apart from the individual OTA’s offsets.</p></li>
<li><p><a class="reference internal" href="calix.common.boundary_check.BoundaryCheckResult.html#calix.common.boundary_check.BoundaryCheckResult.parameters" title="calix.common.boundary_check.BoundaryCheckResult.parameters"><strong>parameters</strong></a> – Currently configured reference potential parameters.
Saved to correct them towards the expected leak parameters if
necessary, cf. allowed_deviation.</p></li>
<li><p><strong>log</strong> – Logger used to log outputs.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="calix.hagen.neuron_synin_coba.COBAReferenceCalib.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_events</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_potential</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_leak_parameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib.__init__" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_events</strong> – Number of events to use during measurement of
synaptic input amplitudes. Has to correspond to how the given
target was measured.</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib.__init__" title="calix.hagen.neuron_synin_coba.COBAReferenceCalib.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(n_events, target_potential, …)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">param n_events</dt>
<dd class="field-odd"><p>Number of events to use during measurement of</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib.configure_parameters" title="calix.hagen.neuron_synin_coba.COBAReferenceCalib.configure_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">configure_parameters</span></code></a>(builder, parameters)</p></td>
<td><p>Configure the given COBA reference potentials.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib.measure_results" title="calix.hagen.neuron_synin_coba.COBAReferenceCalib.measure_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">measure_results</span></code></a>(connection, builder)</p></td>
<td><p>Measure synaptic input amplitudes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib.measure_slope" title="calix.hagen.neuron_synin_coba.COBAReferenceCalib.measure_slope"><code class="xref py py-obj docutils literal notranslate"><span class="pre">measure_slope</span></code></a>(connection[, …])</p></td>
<td><p>Measure the change in resting potential with COBA modulation enabled, depending on the COBA reference potential setting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib.prelude" title="calix.hagen.neuron_synin_coba.COBAReferenceCalib.prelude"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prelude</span></code></a>(connection)</p></td>
<td><p>Calls prelude of CUBA bias calib, which is used for measurements.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="calix.hagen.neuron_synin_coba.COBAReferenceCalib.configure_parameters">
<code class="sig-name descname"><span class="pre">configure_parameters</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">builder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="calix.common.base.WriteRecordingPlaybackProgramBuilder.html#calix.common.base.WriteRecordingPlaybackProgramBuilder" title="calix.common.base.WriteRecordingPlaybackProgramBuilder"><span class="pre">calix.common.base.WriteRecordingPlaybackProgramBuilder</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="calix.common.base.WriteRecordingPlaybackProgramBuilder.html#calix.common.base.WriteRecordingPlaybackProgramBuilder" title="calix.common.base.WriteRecordingPlaybackProgramBuilder"><span class="pre">calix.common.base.WriteRecordingPlaybackProgramBuilder</span></a><a class="headerlink" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib.configure_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Configure the given COBA reference potentials.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>builder</strong> – Builder to append instructions to.</p></li>
<li><p><strong>parameters</strong> – Array of CapMem parameters to configure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Builder with instructions appended.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calix.hagen.neuron_synin_coba.COBAReferenceCalib.measure_results">
<code class="sig-name descname"><span class="pre">measure_results</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pyhxcomm_vx.ConnectionHandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">builder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="calix.common.base.WriteRecordingPlaybackProgramBuilder.html#calix.common.base.WriteRecordingPlaybackProgramBuilder" title="calix.common.base.WriteRecordingPlaybackProgramBuilder"><span class="pre">calix.common.base.WriteRecordingPlaybackProgramBuilder</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="headerlink" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib.measure_results" title="Permalink to this definition"></a></dt>
<dd><p>Measure synaptic input amplitudes.</p>
<p>We reuse the measure_amplitudes function of the CUBA bias calib
for this purpose, but skip recalibrating the CUBA OTA’s reference
potentials, as its bias is unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection</strong> – Connection to the chip to run on.</p></li>
<li><p><strong>builder</strong> – Builder to execute before measuring amplitudes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of measured synaptic input amplitudes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calix.hagen.neuron_synin_coba.COBAReferenceCalib.measure_slope">
<code class="sig-name descname"><span class="pre">measure_slope</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pyhxcomm_vx.ConnectionHandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope_estimation_distance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">numpy.ndarray</span><a class="headerlink" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib.measure_slope" title="Permalink to this definition"></a></dt>
<dd><p>Measure the change in resting potential with COBA modulation
enabled, depending on the COBA reference potential setting.</p>
<p>For two different reference potential settings (one above and
one below the currently set reference potentials), the resting
potentials are measured.
The slope is calculated as the change in resting potential
divided by the difference in reference potential settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection</strong> – Connection to the chip to run on.</p></li>
<li><p><strong>slope_estimation_distance</strong> – Amount to decrease (increase)
COBA reference potential below (above) the previously
configured parameters, in order to estimate the slope.
Given in CapMem LSB, used for the lower (upper) measurement.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="calix.hagen.neuron_synin_coba.COBAReferenceCalib.prelude">
<code class="sig-name descname"><span class="pre">prelude</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pyhxcomm_vx.ConnectionHandle</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="headerlink" href="#calix.hagen.neuron_synin_coba.COBAReferenceCalib.prelude" title="Permalink to this definition"></a></dt>
<dd><p>Calls prelude of CUBA bias calib, which is used for measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>connection</strong> – Connection to the chip to run on.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="calix.hagen.neuron_synin_coba.COBABiasCalib.html" class="btn btn-neutral float-left" title="calix.hagen.neuron_synin_coba.COBABiasCalib" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="calix.hagen.neuron_synin_coba.ExcCOBABiasCalib.html" class="btn btn-neutral float-right" title="calix.hagen.neuron_synin_coba.ExcCOBABiasCalib" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Electronic Vision(s).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>