<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Solving sudokus with BrainScaleS-2 &mdash; BrainScaleS-2 Documentation 0.0.1 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/visions.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Calibration: Characterising and Measuring Analog Behaviour" href="fp_calibration.html" />
    <link rel="prev" title="A simple feedforward network" href="fp_synfireChain.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            BrainScaleS-2 Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Demos &amp; Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Demos and Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="girlsday.html">Wie verarbeitet unser Gehirn Informationen?</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="fortgeschrittenen_praktikum.html">Welcome to the Advanced Physics Lab for Physicists by the Electronic Vision(s) Group</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="fp_biological-background.html">Biological background</a></li>
<li class="toctree-l3"><a class="reference internal" href="fp_neuromorphic-computing.html">Neuromorphic computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="fp_brainscales.html">The BrainScaleS-2 system</a></li>
<li class="toctree-l3"><a class="reference internal" href="fp_pynn_introduction.html">Introduction to PyNN</a></li>
<li class="toctree-l3"><a class="reference internal" href="fp_lui.html">Lu.i experiment</a></li>
<li class="toctree-l3"><a class="reference internal" href="fp_singleNeuron.html">Investigating a single neuron</a></li>
<li class="toctree-l3"><a class="reference internal" href="fp_synfireChain.html">A simple feedforward network</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Solving sudokus with BrainScaleS-2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#experiment-setup">Experiment setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fortgeschrittenen_praktikum.html#optional-experiments">Optional experiments</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../software_components.html">Software Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apis.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BrainScaleS-2 Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Welcome to the BrainScaleS-2 Demos &amp; Examples!</a></li>
          <li class="breadcrumb-item"><a href="fortgeschrittenen_praktikum.html">Welcome to the Advanced Physics Lab for Physicists by the Electronic Vision(s) Group</a></li>
      <li class="breadcrumb-item active">Solving sudokus with BrainScaleS-2</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/brainscales2-demos/fp_sudoku.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="solving-sudokus-with-brainscales-2">
<h1>Solving sudokus with BrainScaleS-2<a class="headerlink" href="#solving-sudokus-with-brainscales-2" title="Permalink to this headline"></a></h1>
<p>In this task we want to apply our newly gained knowledge to a well-known problem:
We will deal with solving a sudoku on spiking hardware.</p>
<p>If you never before encountered this logic puzzle from 1984, let’s define the rules.
Usually you have a 9x9 square grid and the goal is to fill in numbers from 1 to 9, given crucial constraints:</p>
<ol class="arabic simple">
<li><p>In each row, each number is only allowed exactly once.</p></li>
<li><p>In each column, each number is only allowed exactly once.</p></li>
<li><p>In each 3x3 sub grid, each number is only allowed exactly once.</p></li>
</ol>
<p>To find a valid solution, hints are given in form of given, fixed numbers.
An obvious strategy for solving a sudoku is to, sequentially, find a square where only one number is allowed.
This seems trivial but due to the high dimensionality finding a solution is a non-trivial task.
However, checking the correctness of a potential solution is a simple task.
To circumvent the slowness of a brute-force solution one can resort to a stochastic strategy.
In fact, a spiking neuronal network (SNN) can accomplish this task in this manner quickly and with high precision.</p>
<p>The basic idea in creating a sudoku solver with an SNN is to assign to each possible number in each field one neuron, called one-hot encoding.
In our case, each field would have four neurons representing the numbers 1 to 4, respectively.
A neuron being active is interpreted as that field being filled with the respective number, consequently a given, hinted number is represented by a continuously spiking neuron.
An excluding constraint will be realised with an inhibitory synapse due to the suppressing effect on the activity.
To allow the network to explore different states, a random Poisson-distributed background noise is applied to all neurons.
In addition, each neuron is excitatorily connected to itself to maintain possible activity.</p>
<p>Let’s start with a simplified version of a sudoku with a 4x4 grid, as shown in the figure.
Assume the grey three is given, applying the previously mentioned constraints we obtain:</p>
<ul class="simple">
<li><p>Due to 1, the purple threes are not allowed.</p></li>
<li><p>Due to 2, the green threes are not allowed.</p></li>
<li><p>Due to 3, the blue threes are not allowed.</p></li>
<li><p>Due to the choice of our encoding, the orange numbers are not allowed (in each field only one number is allowed to be active)</p></li>
</ul>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../_images/sudoku.png"><img alt="../_images/sudoku.png" src="../_images/sudoku.png" style="width: 60%;" /></a>
<p class="caption"><span class="caption-text">Representation of a 4x4 sudoku with one-hot encoding:
In each small square, each number from 1 to 4 has one respective neuron;
four small squares, framed by the thick line, make one block in the original sudoku;
there are four such blocks to complete the 4x4 sudoku.</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</div>
<p>For further information read into <a class="reference external" href="https://www.kip.uni-heidelberg.de/Veroeffentlichungen/download.php/6118/temp/3666.pdf">Solving the Constraint Satisfaction Problem Sudoku on Neuromorphic Hardware (MA Thesis)</a>.</p>
<div class="section" id="experiment-setup">
<h2>Experiment setup<a class="headerlink" href="#experiment-setup" title="Permalink to this headline"></a></h2>
<p>We start by creating a population with the required number of neurons. Additionally, we create a view for each field to facilitate easier access later
<code class="docutils literal notranslate"><span class="pre">pops_collector[row][field][neuron]</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining total runtime and dimensionality of sudoku</span>
<span class="n">runtime</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">dimension</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># -&gt; we need 4 (rows) * 4 (columns) * 4 (numbers) = 4^3 neurons</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="n">dimension</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">HXNeuron</span><span class="p">())</span>
<span class="n">pop</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="s2">&quot;spikes&quot;</span><span class="p">)</span>

<span class="c1"># to define the connections easier, we save a &quot;view&quot; of each neuron in a list</span>
<span class="n">pops_collector</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
    <span class="n">pops_row</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">field_in_row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
        <span class="n">pops_field</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">number_in_field</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
            <span class="n">neuron</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">PopulationView</span><span class="p">(</span>
                <span class="n">pop</span><span class="p">,</span>
                <span class="p">[</span><span class="n">row</span> <span class="o">*</span> <span class="n">dimension</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">field_in_row</span> <span class="o">*</span> <span class="n">dimension</span>
                <span class="o">+</span> <span class="n">number_in_field</span><span class="p">])</span>
            <span class="n">pops_field</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neuron</span><span class="p">)</span>
        <span class="n">pops_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pops_field</span><span class="p">)</span>
    <span class="n">pops_collector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pops_row</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create background noise</span>
<span class="n">poisson_source</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="n">dimension</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">SpikeSourcePoisson</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="n">runtime</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mf">5e5</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>

<span class="c1"># connect random sources with neurons</span>
<span class="c1"># additionally each neuron is connected to itself excitatorily to</span>
<span class="c1"># sustain possible activity</span>

<span class="n">pynn</span><span class="o">.</span><span class="n">Projection</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span>
                <span class="n">pop</span><span class="p">,</span>
                <span class="n">pynn</span><span class="o">.</span><span class="n">OneToOneConnector</span><span class="p">(),</span>
                <span class="n">synapse_type</span><span class="o">=</span><span class="n">StaticSynapse</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                <span class="n">receptor_type</span><span class="o">=</span><span class="s1">&#39;excitatory&#39;</span><span class="p">)</span>

<span class="n">pynn</span><span class="o">.</span><span class="n">Projection</span><span class="p">(</span><span class="n">poisson_source</span><span class="p">,</span>
                <span class="n">pop</span><span class="p">,</span>
                <span class="n">pynn</span><span class="o">.</span><span class="n">OneToOneConnector</span><span class="p">(),</span>
                <span class="n">synapse_type</span><span class="o">=</span><span class="n">StaticSynapse</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
                <span class="n">receptor_type</span><span class="o">=</span><span class="s1">&#39;excitatory&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create stimulation for clues and connect to according neurons</span>
<span class="n">stim_given_numbers</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="n">SpikeSourceArray</span><span class="p">(</span><span class="n">spike_times</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">runtime</span><span class="p">,</span> <span class="mi">500</span><span class="p">)))</span>

<span class="n">clue_projections</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">clues_row</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">clues_field</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">clues_field</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pynn</span><span class="o">.</span><span class="n">Projection</span><span class="p">(</span>
                <span class="n">stim_given_numbers</span><span class="p">,</span>
                <span class="n">pops_collector</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">][</span><span class="n">number</span><span class="p">],</span>
                <span class="n">pynn</span><span class="o">.</span><span class="n">AllToAllConnector</span><span class="p">(),</span>
                <span class="n">synapse_type</span><span class="o">=</span><span class="n">StaticSynapse</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                <span class="n">receptor_type</span><span class="o">=</span><span class="s1">&#39;excitatory&#39;</span><span class="p">))</span>
        <span class="n">clues_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clues_field</span><span class="p">)</span>
    <span class="n">clue_projections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clues_row</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># functions to solve the sudoku:</span>

<span class="k">def</span> <span class="nf">set_clues</span><span class="p">(</span><span class="n">clues</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the clues in the network.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">clues</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">clues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_clues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clue_projections</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">field_clues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_clues</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">number</span><span class="p">,</span> <span class="n">clue_projection</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">field_clues</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">connection</span> <span class="ow">in</span> <span class="n">clue_projection</span><span class="p">:</span>
                    <span class="n">connection</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="mf">63.</span> <span class="k">if</span> <span class="n">clues</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">number</span> <span class="k">else</span> <span class="mf">0.</span>

<span class="k">def</span> <span class="nf">hide_solution</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">num_clues</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hides the solution and only leaves `num_clues` hints.&quot;&quot;&quot;</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">grid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">grid</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_clues</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The sudoku has less than </span><span class="si">{</span><span class="n">num_clues</span><span class="si">}</span><span class="s2"> clues, which is the number of required clues :(&quot;</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">),</span> <span class="n">num_clues</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="n">clues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
    <span class="n">clues</span><span class="p">[(</span><span class="n">indices</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[(</span><span class="n">indices</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">clues</span>

<span class="k">def</span> <span class="nf">get_solution</span><span class="p">(</span><span class="n">runtime</span><span class="p">,</span> <span class="n">clues</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Executes the network and returns the current solution.&quot;&quot;&quot;</span>
    <span class="n">set_clues</span><span class="p">(</span><span class="n">clues</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># Define duration of poisson spikes</span>
    <span class="n">poisson_source</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="n">runtime</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">)</span>

    <span class="c1"># emulate the network</span>
    <span class="n">pynn</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="n">pynn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
    <span class="c1"># read back solution</span>
    <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_populations</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pops_collector</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">field_populations</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_populations</span><span class="p">):</span>
            <span class="n">num_spikes</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">num_population</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;spikes&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spiketrains</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">num_population</span> <span class="ow">in</span> <span class="n">field_populations</span>
            <span class="p">]</span>
            <span class="n">grid</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">num_spikes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">grid</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constraints</span>

<span class="c1"># create inhibitory connections to neurons in the same field</span>
<span class="c1"># representing different numbers</span>



<span class="c1"># create inhibitory connections to neurons in the same row</span>
<span class="c1"># representing the same number</span>



<span class="c1"># create inhibitory connections to neurons in the same column</span>
<span class="c1"># representing the same number</span>



<span class="c1"># create inhibitory connections to neurons in the same block</span>
<span class="c1"># representing the same number</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">IntSlider</span><span class="p">,</span> <span class="n">FloatSlider</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span>\
    <span class="n">VBox</span><span class="p">,</span> <span class="n">Box</span><span class="p">,</span> <span class="n">HTML</span>


<span class="n">layout</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;calc(100% - 10px)&quot;</span><span class="p">}</span>
<span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;description_width&quot;</span><span class="p">:</span> <span class="s2">&quot;120px&quot;</span><span class="p">}</span>
<span class="n">IntSlider</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">IntSlider</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">controls_parameter</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;num_clues&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;Number Hints&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">)),</span>
    <span class="p">(</span><span class="s2">&quot;random_seed&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;Random Seed&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">65636</span><span class="p">),</span> <span class="mi">1234</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">)),</span>
    <span class="p">(</span><span class="s2">&quot;runtime&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;Runtime&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="mf">.5</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">))</span>
<span class="p">])</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;Configuration&quot;</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">build_gui</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span>
              <span class="n">controls</span><span class="p">,</span>
              <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">defaults</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">copy_configuration</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build a slider-based GUI for an experiment callback function.</span>
<span class="sd">    The sliders are grouped by the specific circuit they affect and the</span>
<span class="sd">    callback&#39;s result (e.g. graph) is displayed above the sliders.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">defaults</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># instantiate sliders according to list of parameters provided by the user</span>
    <span class="n">sliders</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">controls</span><span class="p">:</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">controls_parameter</span><span class="p">[</span><span class="n">con</span><span class="p">]</span>
        <span class="n">default</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">con</span><span class="p">]</span> <span class="k">if</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">defaults</span> <span class="k">else</span> <span class="n">spec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">copy_configuration</span> <span class="ow">and</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">last_configuration</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="n">last_configuration</span><span class="p">[</span><span class="n">con</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">con</span> <span class="o">!=</span> <span class="s2">&quot;runtime&quot;</span><span class="p">:</span>
            <span class="n">sliders</span><span class="p">[</span><span class="n">con</span><span class="p">]</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="n">spec</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                     <span class="nb">max</span><span class="o">=</span><span class="n">spec</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                     <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                     <span class="n">value</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
                                     <span class="n">description</span><span class="o">=</span><span class="n">spec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                     <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">,</span>
                                     <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sliders</span><span class="p">[</span><span class="n">con</span><span class="p">]</span> <span class="o">=</span> <span class="n">FloatSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="n">spec</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                       <span class="nb">max</span><span class="o">=</span><span class="n">spec</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span>
                                       <span class="n">value</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
                                       <span class="n">description</span><span class="o">=</span><span class="n">spec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                       <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">,</span>
                                       <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>

    <span class="n">widget</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="o">**</span><span class="n">sliders</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>

    <span class="c1"># group sliders according to their sections</span>
    <span class="n">sections</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">con</span><span class="p">,</span> <span class="n">slider</span> <span class="ow">in</span> <span class="n">sliders</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">controls_parameter</span><span class="p">[</span><span class="n">con</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">header</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
            <span class="n">sections</span><span class="p">[</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">sections</span><span class="p">[</span><span class="n">header</span><span class="p">][</span><span class="n">con</span><span class="p">]</span> <span class="o">=</span> <span class="n">slider</span>

    <span class="c1"># build UI according to hierarchical structure from above</span>
    <span class="n">u_i</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">header</span><span class="p">,</span> <span class="n">children</span> <span class="ow">in</span> <span class="n">sections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">u_i</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

        <span class="n">u_i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;h3&gt;</span><span class="si">{</span><span class="n">headers</span><span class="p">[</span><span class="n">header</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;/h3&gt;&quot;</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">slider</span> <span class="ow">in</span> <span class="n">children</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">u_i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slider</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># define custom layout following the responsive web design paradigm</span>
    <span class="n">slider_box</span> <span class="o">=</span> <span class="n">Box</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">VBox</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">u_i</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">display</span><span class="o">=</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span>
        <span class="n">grid_template_columns</span><span class="o">=</span><span class="s1">&#39;repeat(auto-fit, minmax(400px, 1fr))&#39;</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="s1">&#39;100%&#39;</span>
    <span class="p">))</span>

    <span class="n">display</span><span class="p">(</span><span class="n">VBox</span><span class="p">([</span><span class="n">slider_box</span><span class="p">,</span> <span class="n">output</span><span class="p">]))</span>

    <span class="n">widget</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pynn_brainscales.brainscales2</span> <span class="k">as</span> <span class="nn">pynn</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="k">class</span> <span class="nc">SudokuPlotter</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">pop</span><span class="p">:</span> <span class="n">pynn</span><span class="o">.</span><span class="n">populations</span><span class="o">.</span><span class="n">Population</span><span class="p">,</span>
        <span class="n">set_clues</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">hide_solution</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">get_solution</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="c1"># Initialize and contain sudoku solver and plotter</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a Sudoku Plotter</span>

<span class="sd">        :param dimension : Size of Sudoku to solve</span>
<span class="sd">        :param pop : pynn.Population of Neurons which run emulation</span>
<span class="sd">        :param set_clues(clues:np.ndarray) : function which sets clues</span>
<span class="sd">            on population</span>
<span class="sd">        :param hide_solution(sudoku, num_clues, seed=None) : Chooses random</span>
<span class="sd">            hints from sudoku returns clues</span>
<span class="sd">        :param get_solution(runtime: float, clues:np.ndarray) : Runs pynn and</span>
<span class="sd">            return solved sudoku</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">=</span> <span class="n">dimension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span> <span class="o">=</span> <span class="n">pop</span>

        <span class="c1"># Sudoku Params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clues</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solved_sudoku</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dimension</span><span class="p">,</span> <span class="n">dimension</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solved_sudoku_correct</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Required functions to solve sudoku</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_clues</span> <span class="o">=</span> <span class="n">set_clues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hide_solution</span> <span class="o">=</span> <span class="n">hide_solution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_solution</span> <span class="o">=</span> <span class="n">get_solution</span>

        <span class="c1"># Config grid itself</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span> <span class="o">=</span> <span class="s2">&quot;gray&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_width</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_major</span> <span class="o">=</span> <span class="mi">4</span>

        <span class="c1"># Config numbers on grid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sudoku_fontsize</span> <span class="o">=</span> <span class="mi">15</span>

        <span class="c1"># Config Activities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space_between_numbers</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">space_between_cells</span> <span class="o">=</span> <span class="mi">4</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">empty_sudoku</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draws onto an axis an empty sudoku grid with dimensions of</span>
<span class="sd">            self.dimension</span>

<span class="sd">        param: ax: plt.axis : Axis to draw on sudoku</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Draw outer box</span>
        <span class="n">outer_box</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mf">.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">],</span>
                     <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mf">.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">]]</span>

        <span class="c1"># Coloring outer edge</span>
        <span class="n">color_outer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solved_sudoku_correct</span><span class="p">:</span>
            <span class="n">color_outer</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">solved_sudoku_correct</span><span class="p">:</span>
            <span class="n">color_outer</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">outer_box</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color_outer</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.85</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.0125</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.85</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.0125</span><span class="p">)</span>

        <span class="c1"># Arange fine lines for squares</span>
        <span class="n">grid_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Draw squares on grid</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">grid_lines</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">grid_lines</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                  <span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span><span class="p">)</span>

        <span class="c1"># If a propper sudoku draw thick lines onto grid</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">49</span><span class="p">]:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">grid_lines</span><span class="p">[::</span><span class="n">step</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                      <span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_major</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">grid_lines</span><span class="p">[::</span><span class="n">step</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">outer_box</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                      <span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_major</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span><span class="p">)</span>

        <span class="c1"># Align ticks as neurons are labeled</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                      <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sudoku_populate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">sudoku</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Insert Numbers from a given sudoku. If field equal 0 no number</span>
<span class="sd">        is written</span>

<span class="sd">        :param ax: plt.axes : Insert numbers onto this axes.</span>
<span class="sd">                            Run before self.empty_sudoku() to create grid</span>
<span class="sd">        :param sudoku: numpy.ndarray : Sudoku with 0 for empty cells</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">y_coord</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sudoku</span><span class="p">):</span>
            <span class="n">y_coord</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_coord</span>
            <span class="k">for</span> <span class="n">x_coord</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                <span class="n">x_coord</span> <span class="o">=</span> <span class="n">x_coord</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_coord</span><span class="p">,</span> <span class="n">y_coord</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span>
                            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                            <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sudoku_fontsize</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sudoku_populate_clues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span>
                              <span class="n">sudoku</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">y_coord</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sudoku</span><span class="p">):</span>
            <span class="n">y_coord</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_coord</span>
            <span class="k">for</span> <span class="n">x_coord</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                <span class="n">x_coord</span> <span class="o">=</span> <span class="n">x_coord</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">x_coord</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">y_coord</span> <span class="o">-</span> <span class="mf">.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                                           <span class="n">fc</span><span class="o">=</span><span class="p">(</span><span class="mf">.85</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="mf">.85</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">11</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">check_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sudoku</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if a sudoku is correct by checking sum in each row.</span>
<span class="sd">        Expected value is</span>
<span class="sd">        x_exp = 1 + ... + dimension</span>

<span class="sd">        :param sudoku:np.ndarray</span>

<span class="sd">        return bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expected_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">sudoku</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">expected_result</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">solve_sudoku</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sudoku</span><span class="p">,</span> <span class="n">runtime</span><span class="p">,</span> <span class="n">num_clues</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes required steps to solve sudoku</span>
<span class="sd">        1. Defines clues -&gt; SudokuPlotter.clues</span>
<span class="sd">        2. Applies clues with set_clues</span>
<span class="sd">        3. Runs emulation (get_solution) and stores in</span>
<span class="sd">            SudokuPlotter.solved_sudoku</span>
<span class="sd">        4. Checks if solution correct with SudokuPlotter.ckeck_solution</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate clues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide_solution</span><span class="p">(</span><span class="n">sudoku</span><span class="p">,</span> <span class="n">num_clues</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_clues</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clues</span><span class="p">)</span>

        <span class="c1"># Solve sudoku</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solved_sudoku</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_solution</span><span class="p">(</span><span class="n">runtime</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clues</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">solved_sudoku_correct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solved_sudoku</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span> <span class="o">=</span> <span class="n">runtime</span>

    <span class="k">def</span> <span class="nf">plot_sudoku</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots sudoku</span>
<span class="sd">        If no axis is given, a new figure is created</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">empty_sudoku</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sudoku_populate</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">solved_sudoku</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sudoku_populate_clues</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clues</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_activities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the activity of each individual neuron</span>
<span class="sd">        If no axis is given, a new figure is created</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

        <span class="n">spiketrains</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">spiketrains</span>

        <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">colors</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">]</span>

        <span class="c1"># Running vaiable for spacing</span>
        <span class="n">current_y</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">spikes</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">spiketrains</span><span class="p">):</span>
            <span class="c1"># Action between different cells</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Draw a horizontal line to split cells</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">current_y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_between_cells</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                           <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
                <span class="n">current_y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_between_cells</span>

            <span class="c1"># Only add labels in first cell</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">index</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> \
                <span class="k">else</span> <span class="kc">None</span>

            <span class="c1"># Plot the acitvity</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="p">[</span><span class="n">current_y</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                       <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">index</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

            <span class="n">current_y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_between_numbers</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;xlim Values: </span><span class="si">{</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span> <span class="o">*</span> <span class="mf">1.08</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

        <span class="c1"># Set y labels at center of cells</span>
        <span class="n">first_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_between_numbers</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">space_between_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">space_between_numbers</span> <span class="o">+</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">space_between_cells</span>

        <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">space_between_labels</span> <span class="o">+</span> \
            <span class="n">first_label</span>
        <span class="n">numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">]&#39;</span>
                  <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">numbers</span><span class="p">)]</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [ms]&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Coordinat [row, column]&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the results</span>
<span class="sd">        if grid is True, makes one plot with grid and anctivities, else two</span>
<span class="sd">            separate images</span>
<span class="sd">        :param grid=True: plots a grid</span>
<span class="sd">        :param figsize=(15,5): standart size of figure, suggested to have a</span>
<span class="sd">            ratio 3:1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># self.solve_sudoku(sudoku, runtime, num_clues, seed=seed)</span>

        <span class="k">if</span> <span class="n">grid</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

            <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

            <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_sudoku</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

            <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_activities</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_sudoku</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_activities</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SP</span><span class="p">:</span> <span class="n">SudokuPlotter</span> <span class="o">=</span> <span class="n">SudokuPlotter</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">set_clues</span><span class="p">,</span> <span class="n">hide_solution</span><span class="p">,</span> <span class="n">get_solution</span><span class="p">)</span>

<span class="c1"># this sudoku shall be solved</span>
<span class="k">global</span> <span class="n">sudoku</span>
<span class="n">sudoku</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The cell below will only work, of course, if you implemented the correct constraints above.</span>
<span class="c1"># Red/green frame show (in)correctness of the proposed solution (consistency with the given sudoku).</span>

<span class="k">def</span> <span class="nf">experiment</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">SP</span><span class="o">.</span><span class="n">solve_sudoku</span><span class="p">(</span><span class="n">sudoku</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;runtime&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;num_clues&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;random_seed&quot;</span><span class="p">])</span>
    <span class="n">SP</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="c1"># plt.savefig(&quot;solved_sudoku.png&quot;, backend=&quot;png&quot;, bbox_inches=&quot;tight&quot;)</span>

<span class="n">build_gui</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;num_clues&quot;</span><span class="p">,</span> <span class="s2">&quot;random_seed&quot;</span><span class="p">,</span> <span class="s2">&quot;runtime&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>The hardware will try to solve the given sudoku.
If you want to implement your own sudoku with unknown numbers you can enter <cite>0</cite> as an empty field.
(<em>Hint</em>: When you change the sudoku, rerun the cell)</p>
<p>The hints are chosen randomly. By varying the seed you vary the position of the clue and by changing the number the sudoku changes the difficulty.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><strong>Task 1:</strong>
Run the network without any constrains, observe the spike pattern and the solution of the sudoku.
Try to explain.</p></li>
</ul>
<ul class="simple">
<li><p><strong>Task 2:</strong>
Now implement the four constrains rules discussed above.
If they are correctly implemented you should get a solved sudoku (keep number of hints and seed).</p></li>
</ul>
<p>Now you have a working sudoku solver. Let’s test it:</p>
<ul class="simple">
<li><p><strong>Task 3:</strong>
Vary the number of clues.
If the solver fails can you find an explanation for that behavior?
Can you think of possible strategies to reduce such errors?
(<em>It might help to inspect the code and numpy documentation</em>)</p></li>
</ul>
<ul class="simple">
<li><p><strong>Task 4:</strong>
What do you expect to happen, if you set the number of clues to zero?
Check your hypothesis.
Can you explain your observation?</p></li>
</ul>
<ul class="simple">
<li><p><strong>Task 5:</strong>
Now, investigate how the success rate is related to the number of clues.
For this, vary the number of clues from four to ten.
Repeat each configuration ten times, while keeping the sudoku fixed.
Visualize your result.</p></li>
<li><p><strong>Task 6:</strong>
Is there a constraint that is not necessarily required?
Why?</p></li>
</ul>
<ul class="simple">
<li><p><strong>Task 7:</strong>
Crunching some numbers:
How many neurons and how many synaptic connections were required in this task?
How many would be required for a 9x9 sudoku?</p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fp_synfireChain.html" class="btn btn-neutral float-left" title="A simple feedforward network" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fp_calibration.html" class="btn btn-neutral float-right" title="Calibration: Characterising and Measuring Analog Behaviour" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Electronic Vision(s).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>