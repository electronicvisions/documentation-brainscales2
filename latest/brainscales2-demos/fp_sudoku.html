

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Sudoku &mdash; BrainScaleS-2 Documentation 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/visions.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PyNN for BrainScaleS-2" href="../pynn-brainscales/index.html" />
    <link rel="prev" title="Binary operations using spiking neurons" href="fp_binary_operations.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> BrainScaleS-2 Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Demos &amp; Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Welcome to the BrainScaleS-2 Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_00-single_neuron.html">BrainScaleS-2 single neuron experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_01-superspike.html">Learning with the SuperSpike rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_02-plasticity_rate_coding.html">BrainScaleS-2 on-chip plasticity experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_03-multicompartment.html">Structured Neurons</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_04-mc_genetic_algorithms.html">How to use Genetic Algorithms to automatically parameterize BrainScaleS-2</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_05-yin_yang.html">Training an SNN on BrainScaleS-2 with PyTorch</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_06-dynamic_range.html">Exploring the dynamic range</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_07-pong.html">Pong</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_08-adex_complex_dynamics.html">Complex neuron dynamics with a silicon adaptive exponential integrate-and-fire neuron</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_08-adex_complex_dynamics.html#understanding-subthreshold-adaptation">Understanding subthreshold adaptation</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_08-adex_complex_dynamics.html#transient-spiking">Transient spiking</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_08-adex_complex_dynamics.html#spike-frequency-adaptation">Spike-frequency adaptation</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_08-adex_complex_dynamics.html#bursting">Bursting</a></li>
<li class="toctree-l2"><a class="reference internal" href="tp_00-introduction.html">Introduction to matrix multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="tp_01-properties.html">Exploring the analog MAC operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tp_02-yin_yang.html">Train DNNs on BrainScaleS-2</a></li>
<li class="toctree-l2"><a class="reference internal" href="nmpi_00-non_interactive_queue_runner.html">Introduction to the non-interactive queue runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="girlsday.html">Wie verarbeitet unser Gehirn Informationen?</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_01_neuromorphic_hardware.html">Unsere neuromorphe Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_02_pynn_introduction.html">Wie können wir mit den künstlichen Nervenzellen kommunizieren?</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_03_single_neuron.html">Experimente mit einer einzelnen Nervenzelle</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_04-1_multiple_neurons_feuerkette.html">Experimente mit mehreren Nervenzellen Teil 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_04-2_multiple_neurons_sudoku.html">Experimente mit mehreren Nervenzellen Teil 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_05_machine_learning.html">Maschinelles Lernen</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_06_logik_operationen.html">Neuronenverbindungen - Synapsen</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_06_logik_operationen.html#synapsennetzwerke">Synapsennetzwerke</a></li>
<li class="toctree-l2"><a class="reference internal" href="fortgeschrittenen_praktikum.html">Welcome to the Advanced Physics Lab for Physicists by the Electronic Vision(s) Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="fp_pynn_introduction.html">Introduction to PyNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="fp_binary_operations.html">Binary operations using spiking neurons</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Sudoku</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pynn-brainscales/index.html">PyNN for BrainScaleS-2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apis.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BrainScaleS-2 Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Welcome to the BrainScaleS-2 Demos &amp; Examples!</a> &raquo;</li>
        
      <li>Sudoku</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/brainscales2-demos/fp_sudoku.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="sudoku">
<h1>Sudoku<a class="headerlink" href="#sudoku" title="Permalink to this headline">¶</a></h1>
<p>Another task a spiking neural network can learn is solving a sudoku.
Since the number of available neurons on chip is limited, we’ll consider
just a 4x4 sudoku.</p>
<a class="reference internal image-reference" href="../_images/sudoku.png"><img alt="../_images/sudoku.png" class="align-center" src="../_images/sudoku.png" style="width: 500px;" /></a>
<p>(Source: Alexander Kugele, “Solving the Constraint Satisfaction Problem
Sudoku on Neuromorphic Hardware”,
<a class="reference external" href="https://www.kip.uni-heidelberg.de/Veroeffentlichungen/download.php/6118/temp/3666.pdf">https://www.kip.uni-heidelberg.de/Veroeffentlichungen/download.php/6118/temp/3666.pdf</a>)</p>
<p>Each field contains four neurons that represent the possible solutions.
When a number is fixed, it prohibits certain combinations according to
the Sudoku rules. For example, consider the gray 3. Since it is fixed,
the numbers 1, 2 or 4 cannot be present in the same field (orange). In
addition, no more 3 may appear in the same row (purple) or in the same
column (green). The same applies to the lower left block (blue). A
fixed number is represented by a continuous firing of the associated
neuron. The forbidden combinations shall be realized by the means of
inhibitory synapses. Consequently, when a number is fixed, all resulting
forbidden possibilities are strongly suppressed by the inhibitory
connections, such that the respective neurons do not fire. In order to
make the remaining allowed neurons fire, all neurons receive weak input
from random background noise. In addition, all neurons are excitatorily
connected to themselves to maintain possible activity.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">ipycanvas</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">w</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="n">IntSlider</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">,</span> <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">ipycanvas</span> <span class="kn">import</span> <span class="n">Canvas</span><span class="p">,</span> <span class="n">hold_canvas</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pynn_brainscales.brainscales2</span> <span class="k">as</span> <span class="nn">pynn</span>
<span class="kn">from</span> <span class="nn">pynn_brainscales.brainscales2.standardmodels.synapses</span> <span class="kn">import</span> <span class="n">StaticSynapse</span>
<span class="kn">from</span> <span class="nn">pynn_brainscales.brainscales2.standardmodels.cells</span> <span class="kn">import</span> \
            <span class="n">SpikeSourceArray</span><span class="p">,</span> <span class="n">HXNeuron</span><span class="p">,</span><span class="n">SpikeSourcePoisson</span>


<span class="kn">from</span> <span class="nn">_static.common.helpers</span> <span class="kn">import</span> <span class="n">setup_hardware_client</span><span class="p">,</span> <span class="n">get_nightly_calibration</span>

<span class="n">runtime</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">dimension</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># set the environment</span>
<span class="n">setup_hardware_client</span><span class="p">()</span>
<span class="n">calib</span> <span class="o">=</span> <span class="n">get_nightly_calibration</span><span class="p">()</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">initial_config</span><span class="o">=</span><span class="n">calib</span><span class="p">)</span>

<span class="c1"># create a neuron for every number in each field</span>
<span class="c1"># -&gt; we need 4 (rows) * 4 (columns) * 4 (numbers) = 4^3 neurons</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating neurons... (1/4)&quot;</span><span class="p">)</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="mi">4</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">HXNeuron</span><span class="p">())</span>
<span class="n">pop</span><span class="o">.</span><span class="n">record</span><span class="p">([</span><span class="s2">&quot;spikes&quot;</span><span class="p">])</span>

<span class="c1"># to define the connections easier, we save a &quot;view&quot; of each neuron in a list</span>
<span class="n">pops_collector</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
    <span class="n">pops_row</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">field_in_row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
        <span class="n">pops_field</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">number_in_field</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
            <span class="n">neuron</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">PopulationView</span><span class="p">(</span>
                <span class="n">pop</span><span class="p">,</span>
                <span class="p">[</span><span class="n">row</span> <span class="o">*</span> <span class="n">dimension</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">field_in_row</span> <span class="o">*</span> <span class="n">dimension</span>
                 <span class="o">+</span> <span class="n">number_in_field</span><span class="p">])</span>
            <span class="n">pops_field</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neuron</span><span class="p">)</span>
        <span class="n">pops_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pops_field</span><span class="p">)</span>
    <span class="n">pops_collector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pops_row</span><span class="p">)</span>

<span class="c1"># each neuron gets individual input from a Poisson distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating background noise... (2/4)&quot;</span><span class="p">)</span>
<span class="n">poisson_source</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="n">dimension</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">SpikeSourcePoisson</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="n">runtime</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mf">5e5</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>

<span class="c1"># connect random sources with neurons</span>
<span class="c1"># additionally each neuron is connected to itself excitatorily to</span>
<span class="c1"># sustain possible activity</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Implementing connections from background and self-connections... (3/4)&quot;</span><span class="p">)</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">Projection</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span>
                <span class="n">pop</span><span class="p">,</span>
                <span class="n">pynn</span><span class="o">.</span><span class="n">OneToOneConnector</span><span class="p">(),</span>
                <span class="n">synapse_type</span><span class="o">=</span><span class="n">StaticSynapse</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
                <span class="n">receptor_type</span><span class="o">=</span><span class="s1">&#39;excitatory&#39;</span><span class="p">)</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">Projection</span><span class="p">(</span><span class="n">poisson_source</span><span class="p">,</span>
                <span class="n">pop</span><span class="p">,</span>
                <span class="n">pynn</span><span class="o">.</span><span class="n">OneToOneConnector</span><span class="p">(),</span>
                <span class="n">synapse_type</span><span class="o">=</span><span class="n">StaticSynapse</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
                <span class="n">receptor_type</span><span class="o">=</span><span class="s1">&#39;excitatory&#39;</span><span class="p">)</span>

<span class="c1"># create stimulation for clues and connect to according neurons</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Preparing clues... (4/4)&quot;</span><span class="p">)</span>
<span class="n">stim_given_numbers</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span>
    <span class="mi">2</span><span class="p">,</span> <span class="n">SpikeSourceArray</span><span class="p">(</span><span class="n">spike_times</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">runtime</span><span class="p">,</span> <span class="mi">500</span><span class="p">)))</span>
<span class="n">clue_projections</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">clues_row</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">clues_field</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">clues_field</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pynn</span><span class="o">.</span><span class="n">Projection</span><span class="p">(</span>
                <span class="n">stim_given_numbers</span><span class="p">,</span>
                <span class="n">pops_collector</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">column</span><span class="p">][</span><span class="n">number</span><span class="p">],</span>
                <span class="n">pynn</span><span class="o">.</span><span class="n">AllToAllConnector</span><span class="p">(),</span>
                <span class="n">synapse_type</span><span class="o">=</span><span class="n">StaticSynapse</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                <span class="n">receptor_type</span><span class="o">=</span><span class="s1">&#39;excitatory&#39;</span><span class="p">))</span>
        <span class="n">clues_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clues_field</span><span class="p">)</span>
    <span class="n">clue_projections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clues_row</span><span class="p">)</span>
</pre></div>
</div>
<p>We define some functions to solve and display the sudoku.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># functions to solve the sudoku:</span>

<span class="k">def</span> <span class="nf">set_clues</span><span class="p">(</span><span class="n">clues</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets the clues in the network.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">clues</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">clues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_clues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clue_projections</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">field_clues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_clues</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">number</span><span class="p">,</span> <span class="n">clue_projection</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">field_clues</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">connection</span> <span class="ow">in</span> <span class="n">clue_projection</span><span class="p">:</span>
                    <span class="n">connection</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="mf">63.</span> <span class="k">if</span> <span class="n">clues</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">number</span> <span class="k">else</span> <span class="mf">0.</span>

<span class="k">def</span> <span class="nf">hide_solution</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">num_clues</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Hides the solution and only leaves `num_clues` hints.&quot;&quot;&quot;</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">grid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">grid</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_clues</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The sudoku has less than </span><span class="si">{</span><span class="n">num_clues</span><span class="si">}</span><span class="s2"> clues, which is the number of required clues :(&quot;</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">),</span> <span class="n">num_clues</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="n">clues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
    <span class="n">clues</span><span class="p">[(</span><span class="n">indices</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[(</span><span class="n">indices</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">clues</span>

<span class="k">def</span> <span class="nf">get_solution</span><span class="p">(</span><span class="n">clues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Executes the network ad returns the current solution.&quot;&quot;&quot;</span>
    <span class="n">set_clues</span><span class="p">(</span><span class="n">clues</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># emulate the network</span>
    <span class="n">pynn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">runtime</span><span class="p">)</span>
    <span class="c1"># read back solution</span>
    <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_populations</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pops_collector</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">field_populations</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_populations</span><span class="p">):</span>
            <span class="n">num_spikes</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">num_population</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;spikes&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spiketrains</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">num_population</span> <span class="ow">in</span> <span class="n">field_populations</span>
            <span class="p">]</span>
            <span class="n">grid</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">num_spikes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">grid</span>

<span class="c1"># functions to display the sudoku:</span>

<span class="k">def</span> <span class="nf">canvas_empty</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">canvas</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates an emtpy canvas for the sudoku.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">canvas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">canvas</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="n">size</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">size</span><span class="o">*</span><span class="n">N</span><span class="p">,</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="s1">&#39;5px&#39;</span><span class="p">))</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">canvas</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">canvas</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">border</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;solid </span><span class="si">{</span><span class="n">size</span><span class="o">/</span><span class="mi">15</span><span class="si">}</span><span class="s1">px black&#39;</span>
    <span class="n">canvas</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="s1">&#39;0.7px sans-serif&#39;</span>
    <span class="n">canvas</span><span class="o">.</span><span class="n">text_align</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">;</span>
    <span class="n">canvas</span><span class="o">.</span><span class="n">text_baseline</span> <span class="o">=</span> <span class="s1">&#39;middle&#39;</span>
    <span class="k">return</span> <span class="n">canvas</span>

<span class="k">def</span> <span class="nf">canvas_sudoku_empty</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">canvas</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates an empty sudoku. Only the numbers are missing.&quot;&quot;&quot;</span>
    <span class="n">Ns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="n">canvas</span> <span class="o">=</span> <span class="n">canvas_empty</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">canvas</span><span class="o">=</span><span class="n">canvas</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">hold_canvas</span><span class="p">(</span><span class="n">canvas</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">canvas</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">15</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="n">Ns</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="o">/</span><span class="mi">30</span>
            <span class="n">canvas</span><span class="o">.</span><span class="n">stroke_line</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">canvas</span><span class="o">.</span><span class="n">stroke_line</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">canvas</span>

<span class="k">def</span> <span class="nf">display_clues</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Displays the clues.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">hold_canvas</span><span class="p">(</span><span class="n">canvas</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_fields</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_fields</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">field</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">canvas</span><span class="o">.</span><span class="n">fill_style</span> <span class="o">=</span> <span class="s1">&#39;#00000022&#39;</span>
                    <span class="n">canvas</span><span class="o">.</span><span class="n">fill_rect</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">check_solution</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks if the sudoku rules are fulfilled.&quot;&quot;&quot;</span>
    <span class="n">Ns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="c1"># j, k index top left hand corner of each 3x3 tile</span>
        <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">//</span> <span class="n">Ns</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ns</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">Ns</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">,:]))</span> <span class="o">!=</span> <span class="n">N</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">grid</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span> <span class="o">!=</span> <span class="n">N</span>\
                   <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="n">Ns</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span><span class="n">k</span><span class="o">+</span><span class="n">Ns</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))</span> <span class="o">!=</span> <span class="n">N</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="n">plot_output</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">display_activity</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">clues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Displays the activity of each neuron over time.&quot;&quot;&quot;</span>
    <span class="c1"># Check if grid is a valid solution which satisfies all clues</span>
    <span class="n">valid_solution</span> <span class="o">=</span> <span class="n">check_solution</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
    <span class="n">valid_clues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">grid</span> <span class="o">==</span> <span class="n">clues</span><span class="p">)[</span><span class="n">clues</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">valid_solution</span> <span class="ow">and</span> <span class="n">valid_clues</span><span class="p">:</span>
        <span class="n">num_correct</span> <span class="o">=</span> <span class="n">dimension</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">num_correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid</span> <span class="o">==</span> <span class="n">sudoku</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="c1">#if num_correct &lt; 16:</span>
    <span class="n">numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">row</span><span class="si">}{</span><span class="n">column</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span>
              <span class="n">product</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">numbers</span><span class="p">)]</span>
    <span class="n">plot_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">plot_output</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;tab10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">colors</span><span class="p">[:</span><span class="n">dimension</span><span class="p">]</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">space_between_numbers</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">space_between_cells</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">current_y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">spikes</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spiketrains</span><span class="p">):</span>
            <span class="c1"># Actions between different cells</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">%</span> <span class="n">dimension</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">current_y</span> <span class="o">+</span> <span class="n">space_between_cells</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                           <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">current_y</span> <span class="o">+=</span> <span class="n">space_between_cells</span>
            <span class="c1"># Only add labels in first cell</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">index</span> <span class="o">%</span> <span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">dimension</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="p">[</span><span class="n">current_y</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">),</span>
                       <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
                       <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">index</span> <span class="o">%</span> <span class="n">dimension</span><span class="p">],</span>
                       <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">current_y</span> <span class="o">+=</span> <span class="n">space_between_numbers</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="c1"># Set y labels at center of cells</span>
        <span class="n">first_label</span> <span class="o">=</span> <span class="n">dimension</span> <span class="o">*</span> <span class="n">space_between_numbers</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">space_between_labels</span> <span class="o">=</span> <span class="n">dimension</span> <span class="o">*</span> <span class="n">space_between_numbers</span> <span class="o">+</span> \
                <span class="n">space_between_cells</span>
        <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dimension</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">space_between_labels</span> <span class="o">+</span> <span class="n">first_label</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ms]&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Sudoku Coordinates [row, column]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="c1">#num_clues = np.count_nonzero(clues)</span>

<span class="k">def</span> <span class="nf">display_solution</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Displays the current solution.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">hold_canvas</span><span class="p">(</span><span class="n">canvas</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_fields</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_fields</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">field</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">canvas</span><span class="o">.</span><span class="n">fill_style</span> <span class="o">=</span> <span class="s1">&#39;#000000dd&#39;</span>
                    <span class="n">canvas</span><span class="o">.</span><span class="n">fill_text</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">field</span><span class="p">),</span> <span class="n">col</span><span class="o">+</span><span class="mf">.5</span><span class="p">,</span> <span class="n">row</span><span class="o">+</span><span class="mf">.5</span><span class="p">)</span>
        <span class="n">canvas</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">border</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> \
            <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; green&#39;</span> <span class="k">if</span> <span class="n">check_solution</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39; darkred&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">display_sudoku_solver</span><span class="p">(</span><span class="n">sudoku</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Displays the sudoku and sliders.&quot;&quot;&quot;</span>
    <span class="n">canvas</span> <span class="o">=</span> <span class="n">canvas_sudoku_empty</span><span class="p">()</span>
    <span class="n">num_clues_slider</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span>
        <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">sudoku</span><span class="p">)),</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of clues&quot;</span><span class="p">)</span>
    <span class="n">seed_slider</span> <span class="o">=</span> <span class="n">IntSlider</span><span class="p">(</span>
        <span class="mi">1234</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Random seed&quot;</span><span class="p">)</span>
    <span class="n">run_button</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;again&quot;</span><span class="p">,</span><span class="n">icon</span><span class="o">=</span><span class="s2">&quot;play&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">solve_sudoku</span><span class="p">(</span><span class="n">num_clues</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Tries to solve the sudoku and displays the result.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">hold_canvas</span><span class="p">(</span><span class="n">canvas</span><span class="p">):</span>
            <span class="n">canvas_sudoku_empty</span><span class="p">(</span><span class="n">canvas</span><span class="o">=</span><span class="n">canvas</span><span class="p">)</span>
        <span class="n">clues</span> <span class="o">=</span> <span class="n">hide_solution</span><span class="p">(</span><span class="n">sudoku</span><span class="p">,</span> <span class="n">num_clues</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
        <span class="n">display_clues</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">clues</span><span class="p">)</span>
        <span class="n">display_solution</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">get_solution</span><span class="p">(</span><span class="n">clues</span><span class="p">))</span>
        <span class="n">display_activity</span><span class="p">(</span><span class="n">get_solution</span><span class="p">(</span><span class="n">clues</span><span class="p">),</span> <span class="n">clues</span><span class="p">)</span>

    <span class="n">interactive</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span>
        <span class="n">solve_sudoku</span><span class="p">,</span> <span class="n">num_clues</span><span class="o">=</span><span class="n">num_clues_slider</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed_slider</span><span class="p">)</span>
    <span class="n">run_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">interactive</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">w</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">canvas</span><span class="p">,</span> <span class="n">w</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">num_clues_slider</span><span class="p">,</span> <span class="n">seed_slider</span><span class="p">,</span> <span class="n">run_button</span><span class="p">])]),</span> <span class="n">plot_output</span><span class="p">]))</span>
    <span class="n">interactive</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Here, you need to implement the prohibition rules.</strong></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Implementing rules...&quot;</span><span class="p">)</span>

<span class="c1"># create inhibitory connections to neurons in the same field</span>
<span class="c1"># representing different numbers</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  - there may only be one number per field&quot;</span><span class="p">)</span>


<span class="c1"># create inhibitory connections to neurons in the same row</span>
<span class="c1"># representing the same number</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  - each number may only occur once per row&quot;</span><span class="p">)</span>


<span class="c1"># create inhibitory connections to neurons in the same column</span>
<span class="c1"># representing the same number</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  - each number may only occur once per column&quot;</span><span class="p">)</span>


<span class="c1"># create inhibitory connections to neurons in the same block</span>
<span class="c1"># representing the same number</span>
<span class="c1"># - which connections actually need to be still realized?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  - each number may only occur once per block&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this sudoku shall be solved</span>
<span class="n">sudoku</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">])</span>

<span class="n">display_sudoku_solver</span><span class="p">(</span><span class="n">sudoku</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Question a:</strong> What happens, if the network just runs like this? Is
this what you would expect?</p>
<p><strong>Task 1:</strong> Now implement the prohibition rules. It might be helpful to
investigate the code used for setting up the network above.</p>
<p>You can try different sudokus by changing the random seed or specifying
them yourself. To do so change the sudoku in the code above and set the
unknown fields to zero. For now, keep the number of clues at eight.</p>
<p>Once you were able to let the neuromorphic chip solve the sudoku for you,
let’s investigate this sudoku solver more closely:</p>
<p><strong>Task 2:</strong> What do you expect to happen, if you set the number of clues
to zero? Check your hypothesis. Can you explain your observation?</p>
<p><strong>Task 3:</strong> Now, investigate how the success rate is related to the
number of clues. For this, vary the number of clues from four to ten.
Repeat each configuration ten times, while keeping the sudoku fixed.
Visualize your result.</p>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../pynn-brainscales/index.html" class="btn btn-neutral float-right" title="PyNN for BrainScaleS-2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="fp_binary_operations.html" class="btn btn-neutral float-left" title="Binary operations using spiking neurons" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, Electronic Vision(s).

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>