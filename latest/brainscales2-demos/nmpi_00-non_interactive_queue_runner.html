

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Introduction to the non-interactive queue runner &mdash; BrainScaleS-2 Documentation 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/visions.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Wie verarbeitet unser Gehirn Informationen?" href="girlsday.html" />
    <link rel="prev" title="Complex neuron dynamics with a silicon adaptive exponential integrate-and-fire neuron" href="ts_08-adex_complex_dynamics.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> BrainScaleS-2 Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Demos &amp; Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Welcome to the BrainScaleS-2 Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_00-single_neuron.html">BrainScaleS-2 single neuron experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_01-superspike.html">Learning with the SuperSpike rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_02-plasticity_rate_coding.html">BrainScaleS-2 on-chip plasticity experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_03-multicompartment.html">Structured Neurons</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_04-mc_genetic_algorithms.html">How to use Genetic Algorithms to automatically parameterize BrainScaleS-2</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_05-yin_yang.html">Training an SNN on BrainScaleS-2 with PyTorch</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_06-dynamic_range.html">Exploring the dynamic range</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_07-pong.html">Pong</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_08-adex_complex_dynamics.html">Complex neuron dynamics with a silicon adaptive exponential integrate-and-fire neuron</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_08-adex_complex_dynamics.html#understanding-subthreshold-adaptation">Understanding subthreshold adaptation</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_08-adex_complex_dynamics.html#transient-spiking">Transient spiking</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_08-adex_complex_dynamics.html#spike-frequency-adaptation">Spike-frequency adaptation</a></li>
<li class="toctree-l2"><a class="reference internal" href="ts_08-adex_complex_dynamics.html#bursting">Bursting</a></li>
<li class="toctree-l2"><a class="reference internal" href="tp_00-introduction.html">Introduction to matrix multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="tp_01-properties.html">Exploring the analog MAC operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tp_02-yin_yang.html">Train DNNs on BrainScaleS-2</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Introduction to the non-interactive queue runner</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#first-experiment">First Experiment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#second-experiment">Second Experiment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#third-experiment-fixed-pattern-noise">Third Experiment: Fixed-pattern noise</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fourth-experiment-external-stimulation">Fourth Experiment: External stimulation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="girlsday.html">Wie verarbeitet unser Gehirn Informationen?</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_01_neuromorphic_hardware.html">Unsere neuromorphe Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_02_pynn_introduction.html">Wie können wir mit den künstlichen Nervenzellen kommunizieren?</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_03_single_neuron.html">Experimente mit einer einzelnen Nervenzelle</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_04-1_multiple_neurons_feuerkette.html">Experimente mit mehreren Nervenzellen Teil 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_04-2_multiple_neurons_sudoku.html">Experimente mit mehreren Nervenzellen Teil 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_05_machine_learning.html">Maschinelles Lernen</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_06_logik_operationen.html">Neuronenverbindungen - Synapsen</a></li>
<li class="toctree-l2"><a class="reference internal" href="gs_06_logik_operationen.html#synapsennetzwerke">Synapsennetzwerke</a></li>
<li class="toctree-l2"><a class="reference internal" href="fortgeschrittenen_praktikum.html">Welcome to the Advanced Physics Lab for Physicists by the Electronic Vision(s) Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="fp_pynn_introduction.html">Introduction to PyNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="fp_binary_operations.html">Binary operations using spiking neurons</a></li>
<li class="toctree-l2"><a class="reference internal" href="fp_sudoku.html">Sudoku</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pynn-brainscales/index.html">PyNN for BrainScaleS-2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apis.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BrainScaleS-2 Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Welcome to the BrainScaleS-2 Demos &amp; Examples!</a> &raquo;</li>
        
      <li>Introduction to the non-interactive queue runner</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/brainscales2-demos/nmpi_00-non_interactive_queue_runner.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="introduction-to-the-non-interactive-queue-runner">
<h1>Introduction to the non-interactive queue runner<a class="headerlink" href="#introduction-to-the-non-interactive-queue-runner" title="Permalink to this headline">¶</a></h1>
<p>Welcome to this tutorial of using pyNN for the BrainScaleS-2 neuromorphic accelerator with the non-interactive queue runner.
We will guide you through all the steps necessary to interact with the system and help you explore the capabilities of the on-chip analog neurons and synapses.
A tutorial of the interactive usage can be found in <a class="reference internal" href="ts_00-single_neuron.html#brainscales-2-single-neuron-experiments"><span class="std std-ref">BrainScaleS-2 single neuron experiments</span></a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install -U hbp_neuromorphic_platform
<span class="o">!</span>pip install ebrains-drive
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nmpi</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">nmpi</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">ebrains_drive</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">ebrains_drive.client</span> <span class="kn">import</span> <span class="n">DriveApiClient</span>
</pre></div>
</div>
<p>The next cell is a workaround for a missing functionality. Just run and ignore…</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define helpers to store and extract required information of the currently used collab</span>
<span class="k">class</span> <span class="nc">RepositoryInformation</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repository</span><span class="p">,</span> <span class="n">repoInfo</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repository</span> <span class="o">=</span> <span class="n">repository</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nameInTheUrl</span> <span class="o">=</span> <span class="n">repoInfo</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repoInfo</span> <span class="o">=</span> <span class="n">repoInfo</span>

    <span class="k">def</span> <span class="nf">toString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;nameInTheUrl=&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nameInTheUrl</span> <span class="o">+</span> <span class="s2">&quot;, full name=&quot;</span> <span class="o">+</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;, id=&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">repository</span><span class="o">.</span><span class="n">id</span>


<span class="k">def</span> <span class="nf">findRepositoryInfoFromDriveDirectoryPath</span><span class="p">(</span><span class="n">homePath</span><span class="p">):</span>
    <span class="c1"># Remove directory structure and subsequent folder names to extract the name of the collab</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">homePath</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/mnt/user/shared/&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)]</span>
    <span class="n">bearer_token</span> <span class="o">=</span> <span class="n">clb_oauth</span><span class="o">.</span><span class="n">get_token</span><span class="p">()</span>
    <span class="n">ebrains_drive_client</span> <span class="o">=</span> <span class="n">ebrains_drive</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="n">bearer_token</span><span class="p">)</span>
    <span class="n">repo_by_title</span> <span class="o">=</span> <span class="n">ebrains_drive_client</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">get_repos_by_filter</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">repo_by_title</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The repository for the collab name&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                        <span class="s2">&quot;can not be found.&quot;</span><span class="p">)</span>

    <span class="c1"># With the repo_by_title we can get the drive ID</span>
    <span class="n">driveID</span> <span class="o">=</span> <span class="n">repo_by_title</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span>

    <span class="c1"># and then we can use the driveID to look up the collab</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://wiki.ebrains.eu/rest/v1/collabs?driveId=&quot;</span> <span class="o">+</span> <span class="n">driveID</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Authorization&#39;</span><span class="p">:</span> <span class="s1">&#39;Bearer </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">bearer_token</span><span class="p">})</span>
    <span class="n">repo_info</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">RepositoryInformation</span><span class="p">(</span><span class="n">repo_by_title</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">repo_info</span><span class="p">)</span>


<span class="c1"># Generate HBP client used to communicate with the hardware and extract</span>
<span class="c1"># collab information from current working directory using the previously</span>
<span class="c1"># defined helpers</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">nmpi</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="nb">dir</span> <span class="o">=!</span>pwd
<span class="n">repoInfo</span> <span class="o">=</span> <span class="n">findRepositoryInfoFromDriveDirectoryPath</span><span class="p">(</span><span class="nb">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Optionally: Set &#39;checkForQuota&#39; to True to check if the currently used</span>
<span class="c1"># collab has an existing quota</span>
<span class="n">checkForQuota</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">checkForQuota</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_resource_requests</span><span class="p">(</span><span class="n">repoInfo</span><span class="o">.</span><span class="n">nameInTheUrl</span><span class="p">)</span>
    <span class="n">anyAccepted</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This collab does not have any quota entry yet. Request a test quota. &quot;</span>
              <span class="s2">&quot;This request will need to be reviewd and granted by an admin.&quot;</span><span class="p">)</span>
        <span class="n">client</span><span class="o">.</span><span class="n">create_resource_request</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test quota request for &quot;</span> <span class="o">+</span> <span class="n">repoInfo</span><span class="o">.</span><span class="n">nameInTheUrl</span><span class="p">,</span>
            <span class="n">collab_id</span><span class="o">=</span><span class="n">repoInfo</span><span class="o">.</span><span class="n">nameInTheUrl</span><span class="p">,</span>
            <span class="n">abstract</span><span class="o">=</span><span class="s2">&quot;Test quota request&quot;</span><span class="p">,</span>
            <span class="n">submit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;accepted&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An accepted quota request exists&quot;</span><span class="p">)</span>
                <span class="n">anyAccepted</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">anyAccepted</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A quota request is present, but it has not yet been granted.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">anyAccepted</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;This collab does not yet have an accepted quota entry. &quot;</span>
            <span class="s2">&quot;Therefore submitting jobs will not yet work.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we define a function which is used to execute the experiments on the BrainScaleS-2 neuromorphic accelerator.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">_static.common.collab_helpers</span> <span class="kn">import</span> <span class="n">check_kernel</span>

<span class="c1"># Check if compatible kernel version is used</span>
<span class="n">check_kernel</span><span class="p">()</span>
<span class="n">kernel_env</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;LAB_KERNEL_NAME&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="s2">&quot;experimental&quot;</span> <span class="ow">in</span> <span class="n">kernel_env</span><span class="p">:</span>
    <span class="n">software_version</span> <span class="o">=</span> <span class="s2">&quot;experimental&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">software_version</span> <span class="o">=</span> <span class="s2">&quot;stable&quot;</span>

<span class="c1"># Directory where we save the experiment results</span>
<span class="n">outputDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">execute_on_hardware</span><span class="p">(</span><span class="n">script_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sends the provided script to the local cluster, where it is scheduled and executed on</span>
<span class="sd">    the neuromorphic chip. The result files are then loaded back into the collaboratory.</span>
<span class="sd">    :param script_name: Name of the script which gets executed</span>
<span class="sd">    :returns: Job id of executed job</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">collab_id</span> <span class="o">=</span> <span class="n">repoInfo</span><span class="o">.</span><span class="n">nameInTheUrl</span>

    <span class="n">hw_config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SOFTWARE_VERSION&#39;</span><span class="p">:</span> <span class="n">software_version</span><span class="p">}</span>

    <span class="n">StartAt</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="c1"># if connection broken, you need a new token (repeat the steps above)</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">submit_job</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">&quot;~/&quot;</span><span class="o">+</span><span class="n">script_name</span><span class="p">,</span>
                          <span class="n">platform</span><span class="o">=</span><span class="n">nmpi</span><span class="o">.</span><span class="n">BRAINSCALES2</span><span class="p">,</span>
                          <span class="n">collab_id</span><span class="o">=</span><span class="n">collab_id</span><span class="p">,</span>
                          <span class="n">config</span><span class="o">=</span><span class="n">hw_config</span><span class="p">,</span>
                          <span class="n">command</span><span class="o">=</span><span class="s2">&quot;run.py&quot;</span><span class="p">,</span>
                          <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">timeUsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">StartAt</span>
    <span class="n">job_id</span> <span class="o">=</span> <span class="n">job</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; time used: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">timeUsed</span><span class="p">))</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">download_data</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">local_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All files: &quot;</span><span class="p">,</span><span class="n">filenames</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">job_id</span>
</pre></div>
</div>
<section id="first-experiment">
<h2>First Experiment<a class="headerlink" href="#first-experiment" title="Permalink to this headline">¶</a></h2>
<p>Now we can start with the first experiment. Here, we will record the membrane of a single, silent
neuron on the analog substrate.
We save our experiment description to a python file and will send this file to a cluster in Heidelberg.
In Heidelberg the experiment is executed on the BrainScaleS-2 neuromorphic system, the results are collected and send back.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">file</span> <span class="o">~/</span><span class="n">first_experiment</span><span class="o">.</span><span class="n">py</span>
<span class="c1"># This first line is used to instruct the notebook not to execute the cell</span>
<span class="c1"># but to write its content into a file.</span>
<span class="kn">from</span> <span class="nn">neo.io</span> <span class="kn">import</span> <span class="n">PickleIO</span>
<span class="kn">import</span> <span class="nn">pynn_brainscales.brainscales2</span> <span class="k">as</span> <span class="nn">pynn</span>
<span class="c1"># To begin with, we configure the logger used during our experiments</span>

<span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">default_config</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">LogLevel</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;single_neuron_demo&quot;</span><span class="p">)</span>

<span class="c1"># The pyNN-interface can be used similarly to existing simulators and other</span>
<span class="c1"># neuromorphic platforms.</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<span class="c1"># In the current state, we only expose the neuron type &#39;HXNeuron&#39;,</span>
<span class="c1"># which allows low-level access to all circuit parameters. It can be</span>
<span class="c1"># configured by passing initial values to the respective Population.</span>
<span class="c1"># Each population may consist of multiple neurons (in this case: one),</span>
<span class="c1"># all sharing the same parameters.</span>
<span class="c1"># Circuit parameters control the dynamic behaviour of the neuron as well as</span>
<span class="c1"># static configuration. Most of them are either boolean or given in units of</span>
<span class="c1"># &#39;LSB&#39; for chip-internal Digital-to-Analog converters - they have no direct</span>
<span class="c1"># biological translation.</span>
<span class="c1"># For this first example, you may alter the leak potential and observe</span>
<span class="c1"># the response of the analog neuron&#39;s resting potential.</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pynn</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">HXNeuron</span><span class="p">(</span>
                      <span class="c1"># Leak potential, range: 300-1000</span>
                      <span class="n">leak_v_leak</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span>
                      <span class="c1"># Leak conductance, range: 0-1022</span>
                      <span class="n">leak_i_bias</span><span class="o">=</span><span class="mi">1022</span><span class="p">)</span>
                 <span class="p">)</span>
<span class="c1"># The chip contains a fast Analog-to-Digital converter. It can be used to</span>
<span class="c1"># record different observables of a single analog neuron - most importantly</span>
<span class="c1"># the membrane potential.</span>
<span class="c1">#</span>
<span class="c1"># The chip additionally includes slower, parallel ADCs which will allow for</span>
<span class="c1"># parallel access to analog signals in multiple neurons. Support for this</span>
<span class="c1"># ADC will be integrated in future versions of our pyNN-Api.</span>
<span class="n">pop</span><span class="o">.</span><span class="n">record</span><span class="p">([</span><span class="s2">&quot;v&quot;</span><span class="p">])</span>

<span class="c1"># Calling pynn.run(time_in_ms) will as a first step apply the static</span>
<span class="c1"># configuration to the neuromorphic substrate. As a second step, the network</span>
<span class="c1"># is evolved for a given amount of time and neurons are stimulated by any</span>
<span class="c1"># stimuli specified by the user.</span>
<span class="c1"># The time is given in units of milliseconds (wall clock time),</span>
<span class="c1"># representing the hardware&#39;s intrinsic 1000-fold speed-up compared to</span>
<span class="c1"># biological systems.</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Store results to disk</span>
<span class="n">PickleIO</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;first_experiment.dat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write_block</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">))</span>

<span class="c1"># Reset the pyNN internal state and prepare for the following experiment</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_experiment_id</span> <span class="o">=</span> <span class="n">execute_on_hardware</span><span class="p">(</span><span class="s1">&#39;first_experiment.py&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The following helper function plots the membrane potential as well as any spikes found in the result file of the experiment. It will be used throughout this tutorial.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">neo.io</span> <span class="kn">import</span> <span class="n">PickleIO</span>

<span class="k">def</span> <span class="nf">plot_membrane_dynamics</span><span class="p">(</span><span class="n">path</span> <span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the neuron data from the given path and plot the membrane potential</span>
<span class="sd">    and spiketrain of the first neuron.</span>
<span class="sd">    :param path: Path to the result file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Experimental results are given in the &#39;neo&#39; data format, the following</span>
    <span class="c1"># lines extract membrane traces as well as spikes and construct a simple</span>
    <span class="c1"># figure.</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">PickleIO</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read_block</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">block</span><span class="o">.</span><span class="n">segments</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">irregularlysampledsignals</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Plotting is supported for populations of size 1.&quot;</span><span class="p">)</span>
        <span class="n">mem_v</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">irregularlysampledsignals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">spiketime</span> <span class="ow">in</span> <span class="n">segment</span><span class="o">.</span><span class="n">spiketrains</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">spiketime</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No spikes found to plot.&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mem_v</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">mem_v</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wall clock time [ms]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;ADC readout [a.u.]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1023</span><span class="p">)</span>  <span class="c1"># ADC precision: 10bit -&gt; value range: 0-1023</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Plot the results of the first experiment.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_membrane_dynamics</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outputDir</span><span class="si">}</span><span class="s2">/job_</span><span class="si">{</span><span class="n">first_experiment_id</span><span class="si">}</span><span class="s2">/first_experiment.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="second-experiment">
<h2>Second Experiment<a class="headerlink" href="#second-experiment" title="Permalink to this headline">¶</a></h2>
<p>As a second experiment, we will let the neurons on BrainScaleS-2 spike by setting a ‘leak-over-threshold’ configuration.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">file</span> <span class="o">~/</span><span class="n">second_experiment</span><span class="o">.</span><span class="n">py</span>
<span class="kn">from</span> <span class="nn">neo.io</span> <span class="kn">import</span> <span class="n">PickleIO</span>
<span class="kn">import</span> <span class="nn">pynn_brainscales.brainscales2</span> <span class="k">as</span> <span class="nn">pynn</span>

<span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">default_config</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">LogLevel</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;single_neuron_demo&quot;</span><span class="p">)</span>

<span class="n">pynn</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<span class="c1"># Since spiking behavior requires the configuration of additional circuits</span>
<span class="c1"># in the neuron, the initial values for our leak-over-threshold population</span>
<span class="c1"># are more complex.</span>
<span class="c1"># The different potentials (leak, reset, threshold) have no direct</span>
<span class="c1"># correspondence: A configured leak potential of 300 might equal a</span>
<span class="c1"># configured threshold potential of value 600 in natural units on the physical</span>
<span class="c1"># system.</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pynn</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">HXNeuron</span><span class="p">(</span>
                          <span class="c1"># Leak potential, range: 300-1000</span>
                          <span class="n">leak_v_leak</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                          <span class="c1"># Leak conductance, range: 0-1022</span>
                          <span class="n">leak_i_bias</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                          <span class="c1"># Threshold potential, range: 0-600</span>
                          <span class="n">threshold_v_threshold</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                          <span class="c1"># Reset potential, range: 300-1000</span>
                          <span class="n">reset_v_reset</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                          <span class="c1"># Membrane capacitance, range: 0-63</span>
                          <span class="n">membrane_capacitance_capacitance</span><span class="o">=</span><span class="mi">63</span><span class="p">,</span>
                          <span class="c1"># Refractory time, range: 0-255</span>
                          <span class="n">refractory_period_refractory_time</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span>
                          <span class="c1"># Enable reset on threshold crossing</span>
                          <span class="n">threshold_enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="c1"># Reset conductance, range: 0-1022</span>
                          <span class="n">reset_i_bias</span><span class="o">=</span><span class="mi">1022</span><span class="p">,</span>
                          <span class="c1"># Enable strengthening of reset conductance</span>
                          <span class="n">reset_enable_multiplication</span><span class="o">=</span><span class="kc">True</span>
                      <span class="p">))</span>
<span class="n">pop</span><span class="o">.</span><span class="n">record</span><span class="p">([</span><span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;spikes&quot;</span><span class="p">])</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Store results to disk</span>
<span class="n">PickleIO</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;second_experiment.dat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write_block</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">get_data</span><span class="p">())</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</div>
<p>Execute the experiment on the neuromorphic hardware and plot the results.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting 2nd experiment at &quot;</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">())</span>
<span class="n">second_experiment_id</span> <span class="o">=</span> <span class="n">execute_on_hardware</span><span class="p">(</span><span class="s1">&#39;second_experiment.py&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start Plotting:&quot;</span><span class="p">)</span>
<span class="n">plot_membrane_dynamics</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outputDir</span><span class="si">}</span><span class="s2">/job_</span><span class="si">{</span><span class="n">second_experiment_id</span><span class="si">}</span><span class="s2">/second_experiment.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="third-experiment-fixed-pattern-noise">
<h2>Third Experiment: Fixed-pattern noise<a class="headerlink" href="#third-experiment-fixed-pattern-noise" title="Permalink to this headline">¶</a></h2>
<p>Due to the analog nature of the BrainScaleS-2 platform, the inevitable mismatch of semiconductor fabrication results in inhomogeneous properties of the computational elements.
We will visualize these effects by recording the membrane potential of multiple neurons in leak-over-threshold configuration.
You will notice different resting, reset and threshold potentials as well as varying membrane time constants.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">file</span> <span class="o">~/</span><span class="n">third_experiment</span><span class="o">.</span><span class="n">py</span>
<span class="kn">from</span> <span class="nn">neo.io</span> <span class="kn">import</span> <span class="n">PickleIO</span>
<span class="kn">import</span> <span class="nn">pynn_brainscales.brainscales2</span> <span class="k">as</span> <span class="nn">pynn</span>

<span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">default_config</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">LogLevel</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;single_neuron_demo&quot;</span><span class="p">)</span>

<span class="n">pynn</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
<span class="n">num_neurons</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="n">num_neurons</span><span class="p">,</span> <span class="n">pynn</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">HXNeuron</span><span class="p">(</span>
                        <span class="c1"># Leak potential, range: 300-1000</span>
                        <span class="n">leak_v_leak</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                        <span class="c1"># Leak conductance, range: 0-1022</span>
                        <span class="n">leak_i_bias</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                        <span class="c1"># Threshold potential, range: 0-600</span>
                        <span class="n">threshold_v_threshold</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                        <span class="c1"># Reset potential, range: 300-1000</span>
                        <span class="n">reset_v_reset</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                        <span class="c1"># Membrane capacitance, range: 0-63</span>
                        <span class="n">membrane_capacitance_capacitance</span><span class="o">=</span><span class="mi">63</span><span class="p">,</span>
                        <span class="c1"># Refractory time, range: 0-255</span>
                        <span class="n">refractory_period_refractory_time</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span>
                        <span class="c1"># Enable reset on threshold crossing</span>
                        <span class="n">threshold_enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="c1"># Reset conductance, range: 0-1022</span>
                        <span class="n">reset_i_bias</span><span class="o">=</span><span class="mi">1022</span><span class="p">,</span>
                        <span class="c1"># Enable strengthening of reset conductance</span>
                        <span class="n">reset_enable_multiplication</span><span class="o">=</span><span class="kc">True</span>
                   <span class="p">))</span>
<span class="k">for</span> <span class="n">neuron_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_neurons</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">INFO</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recording analog variations: Run </span><span class="si">{</span><span class="n">neuron_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Remove recording of previously selected neuron</span>
    <span class="n">p</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="c1"># Record neuron with current neuron id</span>
    <span class="n">p_view</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">PopulationView</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="p">[</span><span class="n">neuron_id</span><span class="p">])</span>
    <span class="n">p_view</span><span class="o">.</span><span class="n">record</span><span class="p">([</span><span class="s2">&quot;v&quot;</span><span class="p">])</span>
    <span class="n">pynn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">pynn</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<span class="c1"># Store results to disk</span>
<span class="n">PickleIO</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;third_experiment.dat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write_block</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_data</span><span class="p">())</span>
</pre></div>
</div>
<p>Execute the experiment on the neuromorphic hardware and plot the results.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">third_experiment_id</span> <span class="o">=</span> <span class="n">execute_on_hardware</span><span class="p">(</span><span class="s1">&#39;third_experiment.py&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start Plotting:&quot;</span><span class="p">)</span>
<span class="n">plot_membrane_dynamics</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outputDir</span><span class="si">}</span><span class="s2">/job_</span><span class="si">{</span><span class="n">third_experiment_id</span><span class="si">}</span><span class="s2">/third_experiment.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The plot shows the recorded membrane traces of multiple different neurons.
Due to the time-continuous nature of the system, there is no temporal alignment between the individual traces, so the figure shows multiple independent effects:
* Temporal misalignment: From the system’s view, the recording happens in an arbitrary time frame during the continuously evolving integration. Neurons are not synchronized to each other.
* Circuit-level mismatch: Each individual neurons shows slightly different analog properties. The threshold is different for all traces; as is the membrane time constant (visible as slope) and the reset potentials (visible as plateaus during the refractory time).</p>
</section>
<section id="fourth-experiment-external-stimulation">
<h2>Fourth Experiment: External stimulation<a class="headerlink" href="#fourth-experiment-external-stimulation" title="Permalink to this headline">¶</a></h2>
<p>Up to now, we have observed analog neurons without external stimulus. In
this experiment, we will introduce the latter and examine post-synaptic
pulses on the analog neuron’s membrane.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">file</span> <span class="o">~/</span><span class="n">fourth_experiment</span><span class="o">.</span><span class="n">py</span>
<span class="kn">from</span> <span class="nn">neo.io</span> <span class="kn">import</span> <span class="n">PickleIO</span>
<span class="kn">import</span> <span class="nn">pynn_brainscales.brainscales2</span> <span class="k">as</span> <span class="nn">pynn</span>
<span class="kn">from</span> <span class="nn">pynn_brainscales.brainscales2.standardmodels.synapses</span> <span class="kn">import</span> <span class="n">StaticSynapse</span>

<span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">default_config</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">LogLevel</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;single_neuron_demo&quot;</span><span class="p">)</span>

<span class="n">pynn</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

<span class="c1"># Preparing the neuron to receive synaptic inputs requires the configuration</span>
<span class="c1"># of additional circuits. The additional settings include technical parameters</span>
<span class="c1"># for bringing the circuit to its designed operating point as well as</span>
<span class="c1"># configuration with a direct biological equivalent.</span>
<span class="n">stimulated_p</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pynn</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">HXNeuron</span><span class="p">(</span>
                                   <span class="c1"># Leak potential, range: 300-1000</span>
                                   <span class="n">leak_v_leak</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                                   <span class="c1"># Leak conductance, range: 0-1022</span>
                                   <span class="n">leak_i_bias</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                                   <span class="c1"># Threshold potential, range: 0-600</span>
                                   <span class="n">threshold_v_threshold</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                                   <span class="c1"># Reset potential, range: 300-1000</span>
                                   <span class="n">reset_v_reset</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                                   <span class="c1"># Membrane capacitance, range: 0-63</span>
                                   <span class="n">membrane_capacitance_capacitance</span><span class="o">=</span><span class="mi">63</span><span class="p">,</span>
                                   <span class="c1"># Refractory time, range: 0-255</span>
                                   <span class="n">refractory_period_refractory_time</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span>
                                   <span class="c1"># Enable reset on threshold crossing</span>
                                   <span class="n">threshold_enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="c1"># Reset conductance, range: 0-1022</span>
                                   <span class="n">reset_i_bias</span><span class="o">=</span><span class="mi">1022</span><span class="p">,</span>
                                   <span class="c1"># Enable strengthening of reset conductance</span>
                                   <span class="n">reset_enable_multiplication</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="c1"># -- Parameters for synaptic inputs -- #</span>
                                   <span class="c1"># Enable synaptic stimulation</span>
                                   <span class="n">excitatory_input_enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">inhibitory_input_enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="c1"># Strength of synaptic inputs</span>
                                   <span class="n">excitatory_input_i_bias_gm</span><span class="o">=</span><span class="mi">1022</span><span class="p">,</span>
                                   <span class="n">inhibitory_input_i_bias_gm</span><span class="o">=</span><span class="mi">1022</span><span class="p">,</span>
                                   <span class="c1"># Synaptic time constants</span>
                                   <span class="n">excitatory_input_i_bias_tau</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                                   <span class="n">inhibitory_input_i_bias_tau</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                                   <span class="c1"># Technical parameters</span>
                                   <span class="n">excitatory_input_i_shift_reference</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                                   <span class="n">inhibitory_input_i_shift_reference</span><span class="o">=</span><span class="mi">300</span><span class="p">))</span>
<span class="n">stimulated_p</span><span class="o">.</span><span class="n">record</span><span class="p">([</span><span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;spikes&quot;</span><span class="p">])</span>

<span class="c1"># Create off-chip populations serving as excitatory external spike sources</span>
<span class="n">exc_spiketimes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.080</span><span class="p">]</span>
<span class="n">exc_stim_pop</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pynn</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">SpikeSourceArray</span><span class="p">,</span>
                               <span class="n">cellparams</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">spike_times</span><span class="o">=</span><span class="n">exc_spiketimes</span><span class="p">))</span>

<span class="c1"># We represent projections as entries in the synapse matrix on the neuromorphic</span>
<span class="c1"># chip. Weights are stored in digital 6bit values (plus sign), the value</span>
<span class="c1"># range for on-chip weights is therefore -63 to 63.</span>
<span class="c1"># With this first projection, we connect the external spike source to the</span>
<span class="c1"># observed on-chip neuron population.</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">Projection</span><span class="p">(</span><span class="n">exc_stim_pop</span><span class="p">,</span> <span class="n">stimulated_p</span><span class="p">,</span>
                <span class="n">pynn</span><span class="o">.</span><span class="n">AllToAllConnector</span><span class="p">(),</span>
                <span class="n">synapse_type</span><span class="o">=</span><span class="n">StaticSynapse</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="mi">63</span><span class="p">),</span>
                <span class="n">receptor_type</span><span class="o">=</span><span class="s2">&quot;excitatory&quot;</span><span class="p">)</span>

<span class="c1"># Create off-chip populations serving as inhibitory external spike sources</span>
<span class="n">inh_spiketimes</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.03</span><span class="p">]</span>
<span class="n">inh_stim_pop</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pynn</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">SpikeSourceArray</span><span class="p">,</span>
                               <span class="n">cellparams</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">spike_times</span><span class="o">=</span><span class="n">inh_spiketimes</span><span class="p">))</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">Projection</span><span class="p">(</span><span class="n">inh_stim_pop</span><span class="p">,</span> <span class="n">stimulated_p</span><span class="p">,</span>
                <span class="n">pynn</span><span class="o">.</span><span class="n">AllToAllConnector</span><span class="p">(),</span>
                <span class="n">synapse_type</span><span class="o">=</span><span class="n">StaticSynapse</span><span class="p">(</span><span class="n">weight</span><span class="o">=-</span><span class="mi">42</span><span class="p">),</span>
                <span class="n">receptor_type</span><span class="o">=</span><span class="s2">&quot;inhibitory&quot;</span><span class="p">)</span>

<span class="c1"># You may play around with the parameters in this experiment to achieve</span>
<span class="c1"># different traces. Try to stack multiple PSPs, try to make the neurons spike,</span>
<span class="c1"># try to investigate differences between individual neuron instances,</span>
<span class="c1"># be creative!</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="c1"># Store results to disk</span>
<span class="n">PickleIO</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;fourth_experiment.dat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write_block</span><span class="p">(</span><span class="n">stimulated_p</span><span class="o">.</span><span class="n">get_data</span><span class="p">())</span>
</pre></div>
</div>
<p>Execute the experiment on the neuromorphic hardware and plot the results.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting 4th experiment at &quot;</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">())</span>
<span class="n">fourth_experiment_id</span> <span class="o">=</span> <span class="n">execute_on_hardware</span><span class="p">(</span><span class="s1">&#39;fourth_experiment.py&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start Plotting:&quot;</span><span class="p">)</span>
<span class="n">plot_membrane_dynamics</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outputDir</span><span class="si">}</span><span class="s2">/job_</span><span class="si">{</span><span class="n">fourth_experiment_id</span><span class="si">}</span><span class="s2">/fourth_experiment.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="girlsday.html" class="btn btn-neutral float-right" title="Wie verarbeitet unser Gehirn Informationen?" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="ts_08-adex_complex_dynamics.html" class="btn btn-neutral float-left" title="Complex neuron dynamics with a silicon adaptive exponential integrate-and-fire neuron" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, Electronic Vision(s).

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>