<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BrainScaleS-2 on-chip plasticity experiment &mdash; BrainScaleS-2 Documentation 0.0.1 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/visions.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Multicompartmental Neurons" href="ts_03-multicompartment.html" />
    <link rel="prev" title="Learning with the SuperSpike rule" href="ts_01-superspike.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            BrainScaleS-2 Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Demos &amp; Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tutorial.html">Demos and Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ts_00-single_neuron.html">BrainScaleS-2 single neuron experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="ts_01-superspike.html">Learning with the SuperSpike rule</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">BrainScaleS-2 on-chip plasticity experiment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#controlling-the-on-chip-plasticity-processor">Controlling the on-chip plasticity processor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-plasticity-kernel">The plasticity kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-experiment">The experiment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ts_03-multicompartment.html">Multicompartmental Neurons</a></li>
<li class="toctree-l3"><a class="reference internal" href="ts_04-mc_genetic_algorithms.html">How to use Genetic Algorithms to automatically parameterize BrainScaleS-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="ts_05-yin_yang.html">Training an SNN on BrainScaleS-2 with PyTorch</a></li>
<li class="toctree-l3"><a class="reference internal" href="ts_06-dynamic_range.html">Exploring the dynamic range</a></li>
<li class="toctree-l3"><a class="reference internal" href="ts_07-pong.html">Pong</a></li>
<li class="toctree-l3"><a class="reference internal" href="ts_08-adex_complex_dynamics.html">Complex Neuron Dynamics with a Silicon Adaptive Exponential Integrate-and-Fire Neuron</a></li>
<li class="toctree-l3"><a class="reference internal" href="ts_09-inside_realtime_hook.html">Demonstration of inside realtime hook</a></li>
<li class="toctree-l3"><a class="reference internal" href="ts_10-multiple_configs.html">Demonstration of multiple chip-reconfigurations during an experiment</a></li>
<li class="toctree-l3"><a class="reference internal" href="ts_11-plasticity_homeostasis.html">BrainScaleS-2 on-chip plasticity experiment</a></li>
<li class="toctree-l3"><a class="reference internal" href="ts_12-hxtorch_snn_intro.html">hxtorch.snn Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tp_00-introduction.html">Introduction to matrix multiplication</a></li>
<li class="toctree-l3"><a class="reference internal" href="tp_01-properties.html">Exploring the analog MAC operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tp_02-yin_yang.html">Train DNNs on BrainScaleS-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="nmpi_00-non_interactive_queue_runner.html">Introduction to the non-interactive queue runner</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#executing-the-notebooks">Executing the Notebooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#shared-hardware-resources">Shared Hardware Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#final-test-hardware-execution">Final test: Hardware Execution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="girlsday.html">Wie verarbeitet unser Gehirn Informationen?</a></li>
<li class="toctree-l2"><a class="reference internal" href="fortgeschrittenen_praktikum.html">Welcome to the Advanced Physics Lab for Physicists by the Electronic Vision(s) Group</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../software_components.html">Software Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apis.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BrainScaleS-2 Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Welcome to the BrainScaleS-2 Demos &amp; Examples!</a></li>
          <li class="breadcrumb-item"><a href="tutorial.html">Welcome to the BrainScaleS-2 Tutorial</a></li>
      <li class="breadcrumb-item active">BrainScaleS-2 on-chip plasticity experiment</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/brainscales2-demos/ts_02-plasticity_rate_coding.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="brainscales-2-on-chip-plasticity-experiment">
<h1>BrainScaleS-2 on-chip plasticity experiment<a class="headerlink" href="#brainscales-2-on-chip-plasticity-experiment" title="Permalink to this headline"></a></h1>
<p>In addition to the analog neural network core, BrainScaleS-2 features two embedded
general-purpose processors, called PPUs (Plasticity Processing Units).
They can be used for experiment control and alterations of configuration during
the run-time of an experiment.
This example makes use of this feature by show-casing synaptic plasticity.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pynn_brainscales.brainscales2</span> <span class="k">as</span> <span class="nn">pynn</span>
<span class="kn">from</span> <span class="nn">dlens_vx_v3</span> <span class="kn">import</span> <span class="n">hal</span><span class="p">,</span> <span class="n">lola</span><span class="p">,</span> <span class="n">halco</span><span class="p">,</span> <span class="n">sta</span>
</pre></div>
</div>
<p>We want to show how the PPUs can be used to rate-code an image in the activity of
neurons (our canvas will be the activity of the neurons over time).
This is done by switching synapses on and off using a predefined data sequence.
Each PPU has 16kiB on-chip memory. For a quadratic image to fit, it is therefore
limited to 64x64 pixels. For simplicity, only one of the two PPUs is used.</p>
<p>For loading and converting an image, some helpers are required:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_image</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read image from file and scale it to the weight range.</span>
<span class="sd">    :param path: Path to image file</span>
<span class="sd">    :return: Image data as numpy array normalised to hardware weight range</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
    <span class="c1"># Scale to weight range [0, 63)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">image</span> <span class="o">/</span> <span class="n">image</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">hal</span><span class="o">.</span><span class="n">SynapseWeightQuad</span><span class="o">.</span><span class="n">Value</span><span class="o">.</span><span class="n">max</span>
    <span class="k">return</span> <span class="n">image</span>
</pre></div>
</div>
<div class="section" id="controlling-the-on-chip-plasticity-processor">
<h2>Controlling the on-chip plasticity processor<a class="headerlink" href="#controlling-the-on-chip-plasticity-processor" title="Permalink to this headline"></a></h2>
<p>Later, we will define the network topology using the pyNN interface.
During the experiment, the PPUs execute an earliest-deadline-first scheduler for
tasks to be performed. In PyNN, execution of a plasticity rule is such a task.
A plasticity rule is injected via the synapse type of a projection and upon execution
is provided with the locations of the synapses in the projection(s) created with this
plastic synapse type. The plasticity rule features a method yielding C++-code to be
executed as a task on the PPU given the synapse location information.
Tasks can be executed periodically, for which a timer object is to be supplied.</p>
<p>For our experiment, we first load an image to be rate-encoded later.</p>
<a class="reference internal image-reference" href="../_images/visions.png"><img alt="../_images/visions.png" class="align-center" src="../_images/visions.png" style="width: 10%;" /></a>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read image into 2d numpy array</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;_static&quot;</span><span class="p">,</span> <span class="s2">&quot;tutorial&quot;</span><span class="p">,</span> <span class="s2">&quot;visions.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Furthermore, we set some environment variables for our microscheduler:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">_static.common.helpers</span> <span class="kn">import</span> <span class="n">setup_hardware_client</span>
<span class="n">setup_hardware_client</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="the-plasticity-kernel">
<h2>The plasticity kernel<a class="headerlink" href="#the-plasticity-kernel" title="Permalink to this headline"></a></h2>
<p>We now define the plasticity rule type with the C++-code which imprints the image
onto the spike-trains by alteration of the synaptic weights.
The image data is transferred into a global object <code class="docutils literal notranslate"><span class="pre">image</span></code>.
The entry point of the plastic task is called <code class="docutils literal notranslate"><span class="pre">PLASTICITY_RULE_KERNEL</span></code>
and is supplied with synapse location information corresponding the the projection
in PyNN. Within the task function, the program writes synapse weight values
row-wise via <code class="docutils literal notranslate"><span class="pre">set_weights(weight_row,</span> <span class="pre">row)</span></code>.
Since the task is scheduled periodically configured via the <code class="docutils literal notranslate"><span class="pre">Timer</span></code> object, after
each write, the period duration is waited before the next row of the image is written.
Over time, this leads to each row of the image being present and imprinting itself
onto the neurons’ firing rate.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">textwrap</span>

<span class="k">class</span> <span class="nc">PlasticityRule</span><span class="p">(</span><span class="n">pynn</span><span class="o">.</span><span class="n">PlasticityRule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">:</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Timer</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize plastic synapse with execution timing information,</span>
<span class="sd">        the image pixels and initial weight.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pynn</span><span class="o">.</span><span class="n">PlasticityRule</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">num_periods</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_kernel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate plasticity rule kernel to be compiled into PPU program.</span>

<span class="sd">        :return: PPU-code of plasticity-rule kernel as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        #include &quot;grenade/vx/ppu/synapse_array_view_handle.h&quot;</span>
<span class="s2">        #include &quot;grenade/vx/ppu/neuron_view_handle.h&quot;</span>
<span class="s2">        #include &quot;libnux/vx/dls.h&quot;</span>
<span class="s2">        #include &lt;array&gt;</span>

<span class="s2">        using namespace grenade::vx::ppu;</span>
<span class="s2">        using namespace libnux::vx;</span>

<span class="s2">        /**</span>
<span class="s2">         * PPU currently executing this code (top/bottom).</span>
<span class="s2">         */</span>
<span class="s2">        extern volatile PPUOnDLS ppu;</span>

<span class="s2">        /**</span>
<span class="s2">         * Image data.</span>
<span class="s2">         */</span>
<span class="s2">        uint8_t const image[</span><span class="si">{image_h}</span><span class="s2">][</span><span class="si">{image_w}</span><span class="s2">] = {{</span>
<span class="s2">            </span><span class="si">{image_pixels}</span>
<span class="s2">        }};</span>

<span class="s2">        /**</span>
<span class="s2">         * Currently to be presented row in image.</span>
<span class="s2">         */</span>
<span class="s2">        uint32_t current_row = 0;</span>

<span class="s2">        void PLASTICITY_RULE_KERNEL(</span>
<span class="s2">            std::array&lt;SynapseArrayViewHandle, 1&gt;&amp; synapses,</span>
<span class="s2">            std::array&lt;NeuronViewHandle, 0&gt;&amp;)</span>
<span class="s2">        {{</span>
<span class="s2">            // only update weights when code is executed on the correct PPU</span>
<span class="s2">            if (synapses[0].hemisphere != ppu) {{</span>
<span class="s2">                return;</span>
<span class="s2">            }}</span>
<span class="s2">            for (size_t row = 0; row &lt; synapses[0].rows.size(); ++row) {{</span>
<span class="s2">                // load new vertical line of image</span>
<span class="s2">                vector_row_t weight_row;</span>
<span class="s2">                size_t w = 0;</span>
<span class="s2">                for (auto const column: synapses[0].columns) {{</span>
<span class="s2">                    weight_row[column] = image[w][current_row];</span>
<span class="s2">                    w++;</span>
<span class="s2">                }}</span>

<span class="s2">                // alter weights in synapse memory</span>
<span class="s2">                synapses[0].set_weights(weight_row, row);</span>
<span class="s2">            }}</span>
<span class="s2">            current_row++;</span>
<span class="s2">        }}</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">image_h</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">),</span> <span class="n">image_w</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="n">image_pixels</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                       <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pixel</span><span class="p">))</span> <span class="k">for</span> <span class="n">pixel</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
                            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="section" id="the-experiment">
<h2>The experiment<a class="headerlink" href="#the-experiment" title="Permalink to this headline"></a></h2>
<p>For this simple binary on-off plasticity, we don’t need the full-fledged capabilities
of the neurons and therefore configure them to bypass-mode, where every incoming spike
elicits an output spike.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pynn</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">enable_neuron_bypass</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Our network uses a single-layer feed-forward structure.
External Poisson stimulus is generated with a constant rate.
We use multiple sources for decorrelation of the neurons’ spikes in order to prevent
congestion effects due to the neuron bypass mode.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bg_props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># ms</span>
    <span class="n">rate</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span>  <span class="c1"># Hz</span>
    <span class="n">duration</span><span class="o">=</span><span class="mi">64</span>  <span class="c1"># ms</span>
<span class="p">)</span>
<span class="n">external_input</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">pynn</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">SpikeSourcePoisson</span><span class="p">(</span><span class="o">**</span><span class="n">bg_props</span><span class="p">))</span>
</pre></div>
</div>
<p>The target population consists of 64 neurons, spikes are recorded.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neurons</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">pynn</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">HXNeuron</span><span class="p">())</span>
<span class="n">neurons</span><span class="o">.</span><span class="n">record</span><span class="p">([</span><span class="s2">&quot;spikes&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Since the external stimulus population’s size matches the internal population’s size,
a one-to-one connector is used as projection.
Initially the weight is set to zero, the PPU will alter it during the experiment.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timer</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span>
    <span class="n">start</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="c1"># ms</span>
    <span class="n">period</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="c1"># ms</span>
    <span class="n">num_periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>
<span class="n">plasticity_rule</span> <span class="o">=</span> <span class="n">PlasticityRule</span><span class="p">(</span><span class="n">timer</span><span class="o">=</span><span class="n">timer</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">)</span>
<span class="n">synapse</span> <span class="o">=</span> <span class="n">pynn</span><span class="o">.</span><span class="n">standardmodels</span><span class="o">.</span><span class="n">synapses</span><span class="o">.</span><span class="n">PlasticSynapse</span><span class="p">(</span>
    <span class="n">plasticity_rule</span><span class="o">=</span><span class="n">plasticity_rule</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pynn</span><span class="o">.</span><span class="n">Projection</span><span class="p">(</span><span class="n">external_input</span><span class="p">,</span>
                <span class="n">neurons</span><span class="p">,</span>
                <span class="n">pynn</span><span class="o">.</span><span class="n">OneToOneConnector</span><span class="p">(),</span>
                <span class="n">synapse_type</span><span class="o">=</span><span class="n">synapse</span><span class="p">)</span>
</pre></div>
</div>
<p>We run the experiment for 64 ms, during which we expect a weight change every ms
leading to all image columns being present as weights for this duration one after
the other.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pynn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="c1"># ms</span>
</pre></div>
</div>
<p>Last, the recorded spike-trains are visualized.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spikes</span> <span class="o">=</span> <span class="n">neurons</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;spikes&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">spiketrains</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">spiketrain</span> <span class="ow">in</span> <span class="n">spikes</span><span class="o">.</span><span class="n">spiketrains</span><span class="p">:</span>
    <span class="n">spiketrains</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spiketrain</span><span class="o">.</span><span class="n">base</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">eventplot</span><span class="p">(</span><span class="n">spiketrains</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#990000&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">64</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">63</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time [ms]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;neuron index&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="test html-display-none highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># assert spikes are recorded</span>
<span class="n">total_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span> <span class="k">for</span> <span class="n">spikes</span> <span class="ow">in</span> <span class="n">spiketrains</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">total_spikes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;No spikes recorded&quot;</span>
</pre></div>
</div>
<p>We see a replicated version of the original image encoded in the time evolution of
the neurons’ firing rates.</p>
<a class="solution reference internal image-reference" href="../_images/plasticity_rate_coding.png"><img alt="../_images/plasticity_rate_coding.png" class="solution align-center" src="../_images/plasticity_rate_coding.png" style="width: 50%;" /></a>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ts_01-superspike.html" class="btn btn-neutral float-left" title="Learning with the SuperSpike rule" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ts_03-multicompartment.html" class="btn btn-neutral float-right" title="Multicompartmental Neurons" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Electronic Vision(s).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>